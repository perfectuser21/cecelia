# DoD - WebSocket 状态推送

QA: docs/QA-DECISION.md

## 验收标准

### 功能验收

- [ ] WebSocket 服务在 Brain (5221) 端口正常启动
      Test: tests/websocket.test.ts

- [ ] 客户端可以连接到 `/ws` 端点
      Test: tests/websocket.test.ts

- [ ] 当 runs 表状态更新时，所有连接的客户端收到推送
      Test: tests/websocket.test.ts

- [ ] 支持多客户端同时连接并接收消息
      Test: tests/websocket.test.ts

- [ ] 断线重连机制工作正常
      Test: manual:使用 wscat 测试断线重连

- [ ] 消息格式正确（包含 type, data, timestamp 字段）
      Test: tests/websocket.test.ts

- [ ] 无内存泄漏（长时间运行稳定）
      Test: manual:运行 24 小时监控内存

### 测试验收

- [ ] npm run test 在 brain 目录通过
      Test: contract:WebSocket-001

- [ ] 手动测试 wscat 连接成功
      Test: manual:wscat -c ws://localhost:5221/ws

### 代码质量

- [ ] TypeScript 类型定义完整
      Test: npm run build

- [ ] 无 ESLint 错误
      Test: npm run lint
