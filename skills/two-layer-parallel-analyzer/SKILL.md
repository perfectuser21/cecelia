---
name: two-layer-parallel-analyzer
description: 对 Notion 页面内容执行双层并行分析，Layer 1 包含话题总结、受众价值分析、IP感知影响、权威增强，Layer 2 生成 5 个 Dan Koe 风格推荐方向
---

# 双层并行内容分析架构 v4（精简版）

## 架构概览

```
输入内容（热点/视频/文章/想法）
         ↓
┌─────────────────────────────────┐
│  第一层：4个维度并行分析（4 agents） │
│  Strategic Analysis Layer        │
└─────────────────────────────────┘
         ↓
    分析结果汇总
         ↓
┌─────────────────────────────────┐
│  第二层：5个大纲并行生成（5 agents） │
│  Content Generation Layer        │
│  (Dan Koe 模板输出)              │
└─────────────────────────────────┘
         ↓
    最终输出：5个 Dan Koe 风格创作大纲
```

---

## 第一层：战略分析层（4个Agents并行）

### Agent 1: 话题总结（Topic Summary）

**任务**：用3-5句话概括核心话题、关键冲突、反直觉洞察

**输出模板**（严格遵循以下结构）：

```
话题总结

[用3-5句话写清楚：
1. 这个内容在讨论什么核心话题？
2. 有什么关键的冲突或悖论？
3. 最反直觉的洞察是什么？]
```

**输出要求**：
- 只写3-5句话，每句话说透一个点
- 聚焦最核心的洞察，不要展开
- 必须提炼出反直觉的真理

---

### Agent 2: 受众价值分析（Audience-Value Fit）

**任务**：识别最匹配的目标人群，分析核心痛点和价值主张

**输出模板**（严格遵循以下结构）：

```
受众价值分析

目标人群
人群定位：[最匹配的目标人群是谁？用1句话说明]
典型特征：[这群人的典型特征，必须和原始内容挂钩]
当前状态：[他们现在处于什么状态？]
核心困惑：[他们最大的困惑是什么？]

核心痛点
[用3-5句话说清楚：这群人的核心痛点是什么？原始内容如何击中这个痛点？必须强关联原始内容]

价值主张
[用3-5句话说清楚：这个内容为什么能让目标人群感兴趣？为什么会停留？为什么会涨粉？]
```

**输出要求**：
- 只写最匹配的一个人群，不要写多个分级
- 人群分析必须和原始内容强关联
- 痛点必须具体，不要泛泛而谈
- 价值主张要说清楚"为什么能吸引人"

---

### Agent 3: IP 感知影响（IP Perception Impact）

**任务**：分析读者会如何感知作者的IP形象，以及产生什么心理反应

**输出模板**（严格遵循以下结构）：

```
IP 感知影响

IP 形象
[用2-3句话描述：读者会把作者感知为什么样的形象？有什么突出的特质？]

受众心理反应
反应1：[第一种心理反应]
反应2：[第二种心理反应]
反应3：[第三种心理反应]
```

**输出要求**：
- IP形象不要评分、不要标签，直接描述
- 心理反应简洁列出即可，不要展开太多

---

### Agent 4: 权威增强与内容杠杆（Authority Enhancement & Content Leverage）

**任务**：匹配权威引用和方法论框架，给出最佳杠杆选择

**输出模板**（严格遵循以下结构）：

```
权威增强与内容杠杆

内容层级：[L1-L5其中一个]

权威引用
引用1："[完整引用]" — [出处]
关联说明：[1-3句话，说清楚这个引用如何关联人群+价值+原始内容+权威性]

引用2："[完整引用]" — [出处]
关联说明：[1-3句话]

[最多3个引用]

方法论框架
框架1：[框架名称]
说明：[1-2句话说清楚这个框架如何应用到原始内容]

框架2：[框架名称]
说明：[1-2句话]

[最多3个框架]

最佳杠杆选择
排序：[按传播潜力排序，如：引用2 + 框架1 > 引用1 + 框架2]
理由：[1-2句话说明为什么这个组合最有传播力]
```

**输出要求**：
- 权威引用1-3个即可
- 关联说明合并成1-3句话，把人群、价值、原始内容、权威内容一起说清楚
- 方法论框架1-3个即可
- 必须给出最佳杠杆选择的排序和理由
- 不要写"应用示例"

---

## 第二层：内容大纲生成层（5个Agents并行）

### Agent 5-9: Dan Koe 风格大纲生成

**任务**：基于第一层的分析结果，生成5个不同角度的 Dan Koe 风格内容大纲

**每个Agent生成一个大纲**，大纲结构如下：

```
大纲标题：[一句话标题]

核心悖论：[用1-2句话说明这个大纲的核心悖论/冲突]

转型弧线：[从认知A → 到认知B]

可执行步骤：
1. [第一步]
2. [第二步]
3. [第三步]

难忘洞察：[一句话金句]
```

**5个大纲的差异化方向**：
- Agent 5：从"揭露真相"角度切入
- Agent 6：从"拥抱不确定性"角度切入
- Agent 7：从"认知与现实的断层"角度切入
- Agent 8：从"概率游戏策略"角度切入
- Agent 9：从"认知革命"角度切入

**输出要求**：
- 每个大纲保持精简，不要过度展开
- 核心悖论必须有冲击力
- 可执行步骤要具体但简洁
- 难忘洞察必须是金句，能让人记住

---

## 执行流程

1. **读取 Notion 页面原始内容**：
   - 使用 Notion API 读取页面内容
   - **关键**：保存原始内容的所有 blocks，绝对不能删除原文

2. **启动第一层（4个并行agents）**：
   - 同时启动 Agent 1, 2, 3, 4
   - 等待所有4个agents完成

3. **汇总第一层结果**

4. **启动第二层（5个并行agents）**：
   - **重要**：必须同时传入：
     - 原始内容的完整文本（包含具体案例、数据、细节）
     - Layer 1 的战略分析结果
   - 同时启动 Agent 5, 6, 7, 8, 9
   - 等待所有5个agents完成

5. **准备分析结果 JSON**：

   将 Layer 1 和 Layer 2 的分析结果整理成以下 JSON 格式：

   ```json
   {
     "layer1": {
       "topic_summary": "[话题总结的3-5句话]",
       "audience": {
         "target_group": "[人群定位]",
         "characteristics": "[典型特征]",
         "current_state": "[当前状态]",
         "core_confusion": "[核心困惑]",
         "pain_points": "[核心痛点的3-5句话]",
         "value_proposition": "[价值主张的3-5句话]"
       },
       "ip_perception": {
         "image": "[IP形象的2-3句话]",
         "reactions": ["反应1", "反应2", "反应3"]
       },
       "authority": {
         "level": "L3",
         "citations": [
           {"quote": "引用内容", "source": "出处", "relevance": "关联说明"},
           {"quote": "引用内容", "source": "出处", "relevance": "关联说明"}
         ],
         "frameworks": [
           {"name": "框架名称", "description": "说明"},
           {"name": "框架名称", "description": "说明"}
         ],
         "best_leverage": {
           "ranking": "排序",
           "reason": "理由"
         }
       }
     },
     "layer2": {
       "outlines": [
         {
           "title": "大纲标题",
           "paradox": "核心悖论",
           "transformation": "转型弧线",
           "steps": ["步骤1", "步骤2", "步骤3"],
           "insight": "难忘洞察"
         },
         // ... 共5个大纲
       ]
     }
   }
   ```

   将此 JSON 保存为临时文件（如 `/tmp/analysis-result-{pageId}.json`）

6. **返回 JSON 结果**：

   **重要**：本 skill 只负责分析，不负责写入 Notion！

   将步骤5生成的 JSON 直接返回给调用者（batch-notion-analyzer skill），格式如下：

   ```json
   {
     "layer1": { ... },
     "layer2": { ... }
   }
   ```

   **不要做以下操作**：
   - ❌ 不要自己调用 Notion API 写入
   - ❌ 不要调用写入脚本
   - ❌ 不要更新页面状态
   - ✅ 只返回 JSON 分析结果即可

   **写入工作由 batch-notion-analyzer skill 负责**，它会调用专门的格式化脚本来保证格式100%一致。

---

## 完整执行示例

假设要处理页面 ID `2a853f41-3ec5-800e-8a3c-e0a287744224`：

**步骤1**: 读取Notion页面原文
**步骤2-4**: 执行 Layer 1 和 Layer 2 分析（9个并行agents）
**步骤5**: 将分析结果保存为 JSON：
```bash
cat > /tmp/analysis-result-2a853f41-3ec5-800e-8a3c-e0a287744224.json << 'EOF'
{
  "layer1": {
    "topic_summary": "这个内容讨论...",
    "audience": {
      "target_group": "...",
      "characteristics": "...",
      "current_state": "...",
      "core_confusion": "...",
      "pain_points": "...",
      "value_proposition": "..."
    },
    "ip_perception": {
      "image": "...",
      "reactions": ["...", "...", "..."]
    },
    "authority": {
      "level": "L3",
      "citations": [...],
      "frameworks": [...],
      "best_leverage": {...}
    }
  },
  "layer2": {
    "outlines": [...]
  }
}
EOF
```

**步骤6**: 调用格式化写入脚本：
```bash
node /home/xx/dev/notion-mcp-complete/write-analysis-with-strict-format.mjs \
  /tmp/analysis-result-2a853f41-3ec5-800e-8a3c-e0a287744224.json \
  2a853f41-3ec5-800e-8a3c-e0a287744224
```

脚本输出：
```
✅ 分析结果写入完成！
原文块数: 4
新分析块数: 78
页面状态: AI 处理
```

---

## 输出格式说明

最终输出不使用 Notion Markdown（不要很多 # 和 *），使用简洁的文本格式，结构清晰即可。

不要在输出中显示 "Agent 1"、"Agent 2" 这种标签，直接使用内容模块的名称即可。

---

## 关键原则

- **精简至上**：话题总结3-5句话，痛点分析3-5句话，价值主张3-5句话
- **强关联原始内容**：所有分析必须和原始内容强关联，不能泛泛而谈
- **固定模板**：严格遵循上述输出模板，不要自己发挥
- **深入但简洁**：每个点说透，但不要展开过多
- **删繁就简**：不需要的字段（如认知转变路径、行为倾向预测、使用建议等）全部删除

---

## 输出格式强制检查清单

**在写入 Notion 之前，必须检查以下格式要求全部满足：**

### 第一层：战略分析（必须包含以下结构，缺一不可）

```
[原文内容保留]

---（divider）

# 第一层：战略分析（heading_1，必须是这个标题）

## 话题总结（heading_2，必须是这个标题）
[3-5句话的段落 paragraph]

## 受众价值分析（heading_2，必须是这个标题）

### 目标人群（heading_3）
人群定位：[paragraph]
典型特征：[paragraph]
当前状态：[paragraph]
核心困惑：[paragraph]

### 核心痛点（heading_3）
[3-5句话的段落 paragraph]

### 价值主张（heading_3）
[3-5句话的段落 paragraph]

## IP 感知影响（heading_2，必须是这个标题）

### IP 形象（heading_3）
[2-3句话的段落 paragraph]

### 受众心理反应（heading_3）
反应1：[paragraph]
反应2：[paragraph]
反应3：[paragraph]

## 权威增强与内容杠杆（heading_2，必须是这个标题）

内容层级：[paragraph，格式："内容层级：L3"这样]

### 权威引用（heading_3）
引用1："..." — [出处]（paragraph）
关联说明：[paragraph]

引用2："..." — [出处]（paragraph）
关联说明：[paragraph]

[可选第3个引用]

### 方法论框架（heading_3）
框架1：[名称]（paragraph）
说明：[paragraph]

框架2：[名称]（paragraph）
说明：[paragraph]

[可选第3个框架]

### 最佳杠杆选择（heading_3）
排序：[paragraph]
理由：[paragraph]
```

### 第二层：内容大纲（必须包含以下结构，缺一不可）

```
---（divider）

# 第二层：内容大纲（heading_1，必须是这个标题）

## 推荐方向 1（heading_2，必须是"推荐方向 1"不是"大纲 #1"）
大纲标题：[paragraph]
核心悖论：[paragraph]
转型弧线：[paragraph]
可执行步骤：（paragraph 或 numbered_list_item）
1. [步骤1]
2. [步骤2]
3. [步骤3]
难忘洞察：[paragraph]

## 推荐方向 2（heading_2）
[同样结构]

## 推荐方向 3（heading_2）
[同样结构]

## 推荐方向 4（heading_2）
[同样结构]

## 推荐方向 5（heading_2）
[同样结构]
```

### 强制要求（违反任何一条都算失败）

1. ✅ 必须有 `heading_1` "第一层：战略分析"
2. ✅ 必须有 `heading_1` "第二层：内容大纲"
3. ✅ 必须有 `heading_2` "话题总结"
4. ✅ 必须有 `heading_2` "受众价值分析"
5. ✅ 必须有 `heading_2` "IP 感知影响"
6. ✅ 必须有 `heading_2` "权威增强与内容杠杆"
7. ✅ 必须有 5 个 `heading_2` "推荐方向 1" 到 "推荐方向 5"
8. ✅ 原文必须完整保留在最前面
9. ✅ 使用 divider 分隔原文和分析、分隔两层分析
10. ✅ 所有段落内容必须简洁（3-5句话）

**如果不能满足以上所有要求，必须重新生成内容，直到完全符合为止。**
