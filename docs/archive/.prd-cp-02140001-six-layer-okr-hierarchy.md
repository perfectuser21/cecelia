---
id: prd-six-layer-okr
version: 1.0.0
created: 2026-02-14
updated: 2026-02-14
changelog:
  - 1.0.0: 初始版本
---

# PRD: 6-Layer OKR Architecture

## 功能描述
实现 6 层 OKR 层级体系：Global OKR → Area OKR → KR → Project → Initiative → Task。

当前代码存在不一致：goals.type 只支持 objective/key_result（2 层），projects 表混用 Project/Sub-Project 概念无 type 列，broken views 引用已删除的 features 表，okr-tick.js 调用错误的 bridge URL。

### 核心变更
1. Migration 029: 扩展 goals.type, 添加 projects.type, 创建 project_repos 表, 修复 broken views
2. Code: selfcheck, planner, actions, executor, okr-tick, routes 全部更新
3. 文档: DEFINITION.md 四层→六层

## 成功标准
- [ ] Migration 029 创建并正确执行
- [ ] selfcheck.js EXPECTED_SCHEMA_VERSION = '029'
- [ ] planner.js 使用新 type 值 (global_okr/area_okr/kr)
- [ ] actions.js: createFeature → createInitiative, 新增 createProject
- [ ] executor.js: /okr prompt 更新, resolveRepoPath 支持 project_repos
- [ ] okr-tick.js: 使用 cecelia-bridge (3457)
- [ ] routes.js: create-initiative 端点工作
- [ ] 所有测试通过 (npx vitest run)
- [ ] facts-check 通过
- [ ] version-sync 通过
- [ ] DEFINITION.md 更新为 6 层架构
- [ ] Version bump (minor: 1.34.0)
