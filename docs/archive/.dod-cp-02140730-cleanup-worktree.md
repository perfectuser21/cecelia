# DoD: Cecelia Executor 任务完成后自动清理 Worktree

## 验收标准

### 功能实现

- [x] `executor.js` 新增 `cleanupWorktree()` 函数 | Test: executor-cleanup.test.js > cleanupWorktree
- [x] `cleanupWorktree()` 能检测 worktree 路径 | Test: executor-cleanup.test.js > getWorktreePath
- [x] `cleanupWorktree()` 能检测未提交改动 | Test: executor-cleanup.test.js > hasUncommittedChanges
- [x] 任务完成回调触发清理 | routes.js:2010-2019, 2128-2137 (completed & failed)
- [x] 清理删除 worktree 目录 | Test: executor-cleanup.test.js > removes worktree
- [x] 清理删除本地分支 | Test: executor-cleanup.test.js > deletes local branch
- [x] 清理删除远端分支（可选） | Test: executor-cleanup.test.js > deletes remote branch
- [x] 有未提交改动时跳过清理 | Test: executor-cleanup.test.js > skips if uncommitted
- [x] 只清理 cp-* 分支 | Test: executor-cleanup.test.js > only cp-* branches
- [x] 清理失败不影响任务状态 | Test: executor-cleanup.test.js > cleanup error handling

### 安全性

- [x] 清理逻辑异步执行，不阻塞 API | .catch() pattern in routes.js
- [x] 清理失败只记录日志，不抛异常 | Test: executor-cleanup.test.js > logs errors
- [x] 分支名校验（只清理 cp-*） | Test: executor-cleanup.test.js > branch validation

### 测试

- [x] 单元测试覆盖所有清理场景 | 16 tests pass in executor-cleanup.test.js
- [x] 现有测试全部通过 | 1248 tests pass (8 failures in learning-effectiveness.test.js are pre-existing)
- [x] facts-check 通过 | ✅ All facts consistent
- [x] version-sync 通过 | ✅ All version files in sync (1.37.0)
