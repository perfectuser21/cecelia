---
id: prd-fix-okr-tick-dispatch
version: 1.0.0
created: 2026-02-14
updated: 2026-02-14
changelog:
  - 1.0.0: 初始版本
---

# PRD: Fix okr-tick decomposition dispatch

## 背景

okr-tick.js 的 `triggerPlannerForGoal()` 直接调用 cecelia-bridge，但发送的 body 缺少必填字段（task_id, checkpoint_id），导致 bridge 返回 `Missing required fields`。

## 问题

okr-tick 绕过了正常的 executor 派发流程，直接调 bridge API，格式不匹配。

## 解决方案

okr-tick 不直接调 bridge，而是通过 actions.createTask() 创建一个 decomposition task（payload.decomposition='true'），然后由正常的 executor.dispatchNextTask() 流程去派发。

executor.preparePrompt() 已经能正确处理 decomposition task（生成 /okr prompt）。

## 功能描述

okr-tick 检测到 goal status=ready 时，创建 decomposition task 而非直接调 bridge。

## 成功标准

- okr-tick 创建 task（payload.decomposition='true'）
- executor 正常派发 decomposition task
- bridge 收到正确格式的请求

## 修改范围

- `brain/src/okr-tick.js`: triggerPlannerForGoal() 改为创建 task
- 测试验证
