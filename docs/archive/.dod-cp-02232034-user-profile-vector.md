## DoD - User Profile Facts 向量化搜索

### 验收清单

- [ ] migration 069 创建 user_profile_facts 表（id, user_id, category, content, embedding vector(1536), created_at）
- [ ] embedding-service.js 新增 generateProfileFactEmbeddingAsync(factId, text)，fire-and-forget，OPENAI_API_KEY 缺失时 no-op
- [ ] extractAndSaveUserFacts 将提取到的 raw_facts 中每条 fact 写入 user_profile_facts 独立行，并触发 embedding
- [ ] getUserProfileContext(pool, userId, conversationText) 支持第三参数：有 conversationText + API key + embeddings → 向量搜索 Top-10 facts
- [ ] getUserProfileContext 无 OPENAI_API_KEY 时降级为结构化字段读取（保持现有行为）
- [ ] getUserProfileContext 无 conversationText 时不做向量搜索，直接返回结构化字段
- [ ] orchestrator-chat.js 传入最近对话文本给 getUserProfileContext
- [ ] selfcheck.js EXPECTED_SCHEMA_VERSION 更新为 '069'
- [ ] selfcheck.test.js + learnings-vectorize.test.js 期望值更新为 '069'
- [ ] 所有现有测试通过（npm test green）
