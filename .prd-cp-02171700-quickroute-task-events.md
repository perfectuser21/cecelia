---
id: prd-quickroute-task-events
version: 1.0.0
created: 2026-02-17
updated: 2026-02-17
changelog:
  - 1.0.0: 初始版本
---

# PRD: 扩展 quickRoute - 任务状态类事件

## 需求来源

当前 quickRoute 函数只处理 3 种事件：HEARTBEAT、TICK（无异常）、TASK_COMPLETED（无问题）。
TASK_FAILED、TASK_TIMEOUT、TASK_CREATED 事件全部转给 Sonnet，造成不必要的 LLM 调用。

## 功能描述

为以下事件类型添加 quickRoute 纯代码处理路径，减少 Sonnet 调用：

- TASK_FAILED（无复杂原因/重试次数未超限）→ retry_task
- TASK_TIMEOUT → log_event + 降级重试
- TASK_CREATED → no_action（事件驱动下游消费）

## 成功标准

- quickRoute 新增 3 种事件类型处理（TASK_FAILED 简单、TASK_TIMEOUT、TASK_CREATED）
- 单元测试覆盖新增分支（5 个新测试）
- 不破坏现有测试
- facts-check 通过
- DevGate 通过
