---
id: dod-agent-monitor-m1
version: 1.0.0
created: 2026-01-29
updated: 2026-01-29
changelog:
  - 1.0.0: Initial version
---

# DoD: Agent Monitor M1

## Acceptance Checklist

### 核心模块 `src/state/agent_monitor.py`

- [x] `ensure_agent_tables()` - 确保表存在
- [x] `parse_output_line()` - 解析单行 JSON
- [x] `create_or_update_run()` - 创建/更新 run
- [x] `record_event()` - 记录事件
- [x] `get_runs()` - 获取 runs 列表
- [x] `get_run()` - 获取单个 run
- [x] `get_events()` - 获取事件列表

### API 路由 `src/api/agent_routes.py`

- [x] `GET /api/agents/runs` - 列出 runs
- [x] `GET /api/agents/runs/:id` - 获取 run 详情
- [x] `GET /api/agents/runs/:id/events` - 获取事件列表
- [x] `GET /api/agents/runs/active` - 获取活跃 runs
- [x] `GET /api/agents/runs/summary` - 获取统计摘要

### 集成

- [x] `src/api/main.py` 注册 agent_router
- [x] `src/state/__init__.py` 导出 agent_monitor

### 测试

- [x] `tests/test_agent_monitor.py` 存在
- [x] `pytest tests/test_agent_monitor.py -v` 通过
- [ ] CI passes
- [ ] PR merged to develop
