---
id: dod-vector-memory-ops
version: 1.0.0
created: 2026-02-17
updated: 2026-02-17
changelog:
  - 1.0.0: 初始版本
---

# DoD: Vector Memory 运维补齐

## 验收清单

- [ ] **rolling-update.sh**: 两处 docker run 均有 `-e "OPENAI_API_KEY=${OPENAI_API_KEY}"`
- [ ] **embedding-service.js**: 新文件，`generateTaskEmbeddingAsync()` 函数存在
- [ ] **routes.js**: execution-callback 里调用 embedding-service（fire-and-forget）
- [ ] **Test**: 新增 embedding-service 单元测试（mock openai-client）
- [ ] **GoldenPath**: `bash scripts/goldenpath-check.sh` 通过

## CI 映射

| DoD 项 | Test |
|--------|------|
| embedding-service.js 存在 | brain/src/__tests__/embedding-service.test.js |
| generateTaskEmbeddingAsync() no-op when no API key | embedding-service.test.js > no OPENAI_API_KEY |
| generateTaskEmbeddingAsync() calls openai-client | embedding-service.test.js > with API key |
| 失败静默不抛出 | embedding-service.test.js > failure silent |
