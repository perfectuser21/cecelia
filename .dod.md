---
id: migration-070-dept-heartbeat-task-type-dod
version: 1.0.0
created: 2026-02-23
updated: 2026-02-23
changelog:
  - 1.0.0: 初始版本
---

# DoD: Migration 070 — dept_heartbeat task_type 约束

- [ ] migration 070 文件存在：`brain/migrations/070_dept_heartbeat_task_type.sql`
  - Test: `ls brain/migrations/070_*.sql`
- [ ] 约束修改正确：`tasks_task_type_check` 包含 `dept_heartbeat`
  - Test: migration SQL 中有 DROP CONSTRAINT + ADD CONSTRAINT 且列表含 `dept_heartbeat`
- [ ] selfcheck.js EXPECTED_SCHEMA_VERSION = '070'
  - Test: `grep EXPECTED_SCHEMA_VERSION brain/src/selfcheck.js`
- [ ] schema_version 有 '070' 记录
  - Test: migration SQL 中有 INSERT INTO schema_version VALUES ('070', ...)
- [ ] 测试文件存在，验证 dept_heartbeat 可以插入 tasks
  - Test: `ls brain/src/__tests__/dept-heartbeat-task-type.test.js`
- [ ] npm test 全部通过
  - Test: `npm test`
