---
id: prd-quickroute-task-events
version: 2.0.0
created: 2026-02-17
updated: 2026-02-18
changelog:
  - 1.0.0: 初始版本
  - 2.0.0: 扩展为全量 quickRoute 同步（添加 5 个新事件类型）
---

# PRD: 扩展 quickRoute - 全量事件覆盖同步

## 需求来源

本轮 quickRoute 扩展新增多批事件类型快速路由规则，需统一做一次 facts-check 和文档同步。

## 功能描述

为以下事件类型添加 quickRoute 规则（无需调用 Sonnet）：
- TASK_FAILED（无复杂原因/重试次数未超限）→ retry_task
- TASK_FAILED（重试超限且无复杂原因）→ cancel_task
- TASK_TIMEOUT → log_event + 降级重试
- TASK_CREATED → no_action（事件驱动下游消费）
- OKR_CREATED → log_event
- OKR_PROGRESS_UPDATE（非阻塞）→ log_event
- OKR_BLOCKED（非严重）→ notify_user + mark_task_blocked
- DEPARTMENT_REPORT（非严重）→ log_event
- EXCEPTION_REPORT（低严重度）→ log_event
- RESOURCE_LOW（非严重）→ notify_user
- USER_COMMAND（简单）→ log_event
- USER_MESSAGE（非紧急）→ log_event

## 成功标准

- node scripts/facts-check.mjs 全通过（无 FAIL）
- bash scripts/check-version-sync.sh 全通过
- npm test 在 brain/ 目录下全通过
- DEFINITION.md 记录完整 quickRoute 覆盖事件列表（10+ 事件类型）
- 所有新增 quickRoute 规则有对应单元测试

## 非目标

不修改 ACTION_WHITELIST（action_count 维持 27）
