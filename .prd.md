## PRD - Brain Bootstrap: 让 Cecelia 彻底活起来

**需求来源**: Brain tick 系统缺少关键闭环，导致 4/5 目标空转
**功能描述**: 修复 5 个关键缺口，实现 Brain 完整自治循环

## 缺口分析

| # | 缺口 | 根因 | 影响 |
|---|------|------|------|
| 1 | Agent 回调失败 | cecelia-bridge 把 WEBHOOK_URL 指向 N8N，CORE_API 端口错（5212→5221） | agent 干完 Brain 不知道，60 分钟超时才标 fail |
| 2 | 无自动 OKR 拆解 | tick 遇到 0 KR 目标直接跳过，不触发秋米 | 4/5 目标永远空转 |
| 3 | 进程追踪失效 | bridge 模式 pid=null，tracked 永远是 0 | 无法判断 agent 是否存活 |
| 4 | repo_path 不传 | executor 不传 repo_path 给 bridge/cecelia-run | 所有 agent 跑在同一目录 |

## 修复方案

### 1. 回调修复
- `cecelia-bridge.js`: WEBHOOK_URL → `http://localhost:5221/api/brain/execution-callback`
- `cecelia-bridge.js`: 新增 `CECELIA_CORE_API=http://localhost:5221`
- 验证: agent 完成后 Brain 立即更新 task status

### 2. 自动 OKR 拆解
- `brain/src/tick.js`: 当 `krIds.length === 0` 时，检查是否已有拆解任务
- 无则创建 task_type='research' 任务触发秋米拆解
- 防重复：检查该 objective 是否已有 pending/in_progress 的拆解任务

### 3. 进程追踪
- `brain/src/executor.js`: 回调收到时清理 activeProcesses
- 利用已有的 execution-callback 端点触发清理
- 不依赖 PID，改用 task 生命周期追踪

### 4. repo_path 传递
- `brain/src/executor.js`: 查询 task 关联的 project.repo_path，传给 bridge
- `cecelia-bridge.js`: 接收 repo_path，设为 CECELIA_WORK_DIR 环境变量
- cecelia-run 已支持 CECELIA_WORK_DIR，无需改动

## 涉及文件

**Brain 代码（本仓库）:**
- `brain/src/tick.js` — 添加自动 OKR 拆解逻辑
- `brain/src/executor.js` — 传 repo_path，改进追踪

**主机脚本（仓库外）:**
- `/home/xx/bin/cecelia-bridge.js` — 修复回调 URL，接收 repo_path
