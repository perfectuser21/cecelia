---
id: orchestrator-db-persistence
version: 1.0.0
created: 2026-01-29
updated: 2026-01-29
changelog:
  - 1.0.0: 初始版本
---

## PRD - Orchestrator 数据库持久化

**需求来源**: Orchestrator 当前是内存存储，重启数据丢失，需要持久化到 PostgreSQL

**功能描述**:
1. 创建数据库表：trds, tasks, runs
2. 修改 routes.py 把内存操作改成 DB 操作
3. 保持 API 接口不变

**涉及文件**:
- src/db/migrations/xxx_orchestrator_tables.sql（新建）
- src/orchestrator/routes.py（修改 - 内存 → DB）

**成功标准**:
- [ ] trds 表存在且能 CRUD
- [ ] tasks 表存在且能 CRUD
- [ ] runs 表存在且能 CRUD
- [ ] /orchestrator/v2/* API 功能不变
- [ ] 重启后数据不丢失
- [ ] 现有测试通过
