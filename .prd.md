---
id: prd-decomposition-api-endpoints
version: 1.0.0
created: 2026-02-24
updated: 2026-02-24
changelog:
  - 1.0.0: 初始版本
---

# PRD - 无拆解任务检测功能 HTTP API 端点

## 需求来源
为无拆解任务检测功能提供 HTTP API 端点，支持手动查询、触发检测和监控统计信息。

## 功能描述
在 Cecelia Core Brain 中新增 HTTP API 端点，支持以下功能：
1. 查询缺失拆解任务的 Initiative 列表
2. 手动触发为缺失拆解任务的 Initiative 创建任务
3. 获取拆解任务统计信息
4. 在系统状态 API 中添加相关指标

## 涉及文件
- `brain/src/routes.js` - 添加新的 API 端点
- `brain/src/decomposition-checker.js` - 导出 API 所需函数，确保函数可被外部调用
- `brain/src/__tests__/routes.test.js` - 添加新端点的测试

## API 端点设计
1. `GET /api/brain/decomposition/missing` - 查询缺失拆解任务的 Initiative 列表
2. `POST /api/brain/decomposition/create-missing` - 手动触发为缺失拆解任务的 Initiative 创建任务
3. `GET /api/brain/decomposition/stats` - 获取拆解任务统计信息

## 成功标准
1. API 端点能够正确返回缺失拆解任务的 Initiative 列表
2. 手动触发创建拆解任务功能正常工作
3. 统计信息准确反映系统状态
4. API 响应格式标准化，包含适当的错误处理
5. 权限控制和安全性考虑
6. 所有新端点都有对应的单元测试

## 非目标
- 不修改现有的 decomposition-checker.js 核心逻辑
- 不涉及前端界面变更（属于 workspace 范围）
- 不改变现有 tick 循环的拆解检测机制
