---
id: fix-plan-route-conflict
version: 1.0.0
created: 2026-02-07
updated: 2026-02-07
changelog:
  - 1.0.0: 初始版本
---

# Fix: POST /plan 路由冲突

## 问题

`routes.js` 中有两个 `POST /plan` 路由：
1. Line ~2768：旧的 OKR Plan 入口（`handlePlanInput`）
2. Line ~4077：新的 Proposal 系统入口（`createProposal`）

Express 按注册顺序匹配，旧路由先注册，新 Proposal 路由永远不会被命中。

## 修复方案

将新 Proposal 创建路由从 `POST /plan` 改为 `POST /proposals`，与其他 proposal 端点路径保持一致：

- `POST /proposals` — 创建提案（原 `POST /plan`）
- `GET /proposals` — 列出提案
- `GET /proposals/:id` — 查看提案
- `POST /proposals/:id/approve` — 审批
- `POST /proposals/:id/reject` — 拒绝
- `POST /proposals/:id/rollback` — 回滚

## 影响范围

- `brain/src/routes.js`：改一行路由路径 + 更新注释
- `DEFINITION.md`：更新 API 端点文档（如有引用）

## 成功标准

1. `POST /api/brain/proposals` 能成功创建提案
2. 旧 `POST /api/brain/plan` 继续正常工作（OKR Plan）
3. Brain 测试不回归 + DevGate 全绿
