---
id: prd-brain-service-deployment
version: 1.0.0
created: 2026-01-29
updated: 2026-01-29
changelog:
  - 1.0.0: åˆå§‹ç‰ˆæœ¬
---

# PRD: Brain Service éƒ¨ç½²

## ğŸ“‹ é¡¹ç›®ä¿¡æ¯

| é¡¹ç›® | ä¿¡æ¯ |
|------|------|
| **TRD** | ç‹¬ç«‹ |
| **ç›®æ ‡ä»“åº“** | cecelia-semantic-brain |
| **æŠ€æœ¯æ ˆ** | Python + FastAPI + Docker + systemd |

---

## ğŸ”— ä¾èµ–

```yaml
depends_on: []  # æ— å‰ç½®
blocks: [Core å‰ç«¯é›†æˆ]
```

---

## ğŸ¯ ç›®æ ‡

**æŠŠ Brain ä½œä¸ºç‹¬ç«‹æœåŠ¡éƒ¨ç½²è¿è¡Œï¼Œä¾› Core å‰ç«¯å’Œå…¶ä»–æœåŠ¡è°ƒç”¨ã€‚**

### æœ¬æ¬¡ PR èŒƒå›´

1. **Docker é…ç½®**
   - Dockerfile
   - docker-compose.yml
   - ç¯å¢ƒå˜é‡æ¨¡æ¿

2. **Systemd æœåŠ¡**
   - brain.service å•å…ƒæ–‡ä»¶
   - è‡ªåŠ¨é‡å¯é…ç½®

3. **å¥åº·æ£€æŸ¥**
   - GET /health ç«¯ç‚¹
   - æ•°æ®åº“è¿æ¥æ£€æŸ¥

4. **ç«¯å£åˆ†é…**
   - Brain API: 5220 (å¼€å‘) / 5221 (ç”Ÿäº§)

### ä¸åœ¨èŒƒå›´å†…

- âŒ ä¸åš Nginx é…ç½®ï¼ˆç”¨ Cloudflare Tunnelï¼‰
- âŒ ä¸åš SSLï¼ˆTunnel å¤„ç†ï¼‰

---

## ğŸ“¦ æ¶‰åŠæ–‡ä»¶

### æ–°å¢

| æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|
| `Dockerfile` | Docker é•œåƒæ„å»º |
| `docker-compose.yml` | å®¹å™¨ç¼–æ’ |
| `.env.example` | ç¯å¢ƒå˜é‡æ¨¡æ¿ |
| `scripts/start.sh` | å¯åŠ¨è„šæœ¬ |
| `brain.service` | Systemd æœåŠ¡æ–‡ä»¶ |

### ä¿®æ”¹

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `src/api/main.py` | æ·»åŠ  /health ç«¯ç‚¹ |

---

## âœ… éªŒæ”¶æ ‡å‡†

- [ ] Docker å®¹å™¨å¯æ„å»º
- [ ] docker-compose up æ­£å¸¸å¯åŠ¨
- [ ] GET /health è¿”å› 200
- [ ] Brain API å¯é€šè¿‡ 5220 ç«¯å£è®¿é—®
- [ ] æœåŠ¡é‡å¯åè‡ªåŠ¨æ¢å¤

---

## ğŸ§ª æµ‹è¯•è®¡åˆ’

| æµ‹è¯• | å‘½ä»¤ |
|------|------|
| å®¹å™¨æ„å»º | `docker build -t brain .` |
| æœåŠ¡å¯åŠ¨ | `docker-compose up -d` |
| å¥åº·æ£€æŸ¥ | `curl localhost:5220/health` |
| API æµ‹è¯• | `curl localhost:5220/api/brain/focus` |

---

## ğŸ“ ç«¯å£è§„åˆ’

| æœåŠ¡ | å¼€å‘ç«¯å£ | ç”Ÿäº§ç«¯å£ |
|------|----------|----------|
| Core | 5212 | 5211 |
| Brain | 5220 | 5221 |
