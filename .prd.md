---
id: prd-cecelia-page-liveness
version: 2.0.0
created: 2026-02-26
updated: 2026-02-26
changelog:
  - 2.0.0: 指挥室活性修复（EventStream 历史加载 + cluster 字段映射）
  - 1.0.0: 初始数据对齐（PR #12 已合并）
---

# PRD: CeceliaPage 指挥室活性修复

## 背景

PR #12 修复了 status/full 和 WebSocket 广播后，CeceliaPage 仍然"死气沉沉"：
- EventStream（右栏 1/3）打开时永远空白，只显示"等待事件..."
- 集群数据因 API 解析路径错误全部显示 0
- AgentMonitor 在无任务时仅显示灰色空状态

三栏布局中有两栏半处于空白/错误状态。

## 目标

让 CeceliaPage 打开后立即有丰富内容，体现 Cecelia 24/7 忙碌工作的状态。

## 具体需求

### 1. EventStream 历史事件加载（致命）
- 后端新增 `/api/brain/events/recent` 路由，从 cecelia_events 表返回最近 50 条事件
- 前端 CeceliaPage 初始化时调用此 API，填充 EventStream
- 不再依赖纯 WebSocket 实时推送才能看到事件

### 2. cluster/status 前端解析修复（致命）
- 后端返回 `{ success: true, cluster: { servers: [...] } }`
- 前端找顶层 `{ servers: [...] }`，匹配不上 → clusterNodes 永远空
- 修复 CeceliaPage.tsx 的集群数据解析：`d.cluster?.servers`
- 字段映射：`resources.cpu_pct` → cpu_percent，`mem_total_gb - mem_free_gb` → memory_used_gb，`slots.used` → active_agents，`slots.available` → available_slots

### 3. Brain 版本更新
- patch bump（修复类）
