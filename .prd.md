# PRD: 数据库连接配置统一化

## 需求来源

审计发现 `brain/src/db.js` 的兜底默认值（`cecelia_tasks`/`n8n_user`/`n8n_password_2025`）与实际数据库（`cecelia`/`cecelia`/`CeceliaUS2026`）不一致。来源于早期 n8n 时代遗留配置。

此外 `migrate.js`、`selfcheck.js`、4 个测试文件各自硬编码默认值，存在 6 处重复。

## 功能描述

### 改动范围

1. **新建 `brain/src/db-config.js`** — 数据库连接参数的唯一来源
   - 导出 `DB_DEFAULTS` 对象：host, port, database, user, password
   - 默认值与 `.env.docker` 一致

2. **修改 `brain/src/db.js`** — 改为从 `db-config.js` 读取默认值
   - 删除硬编码的 `cecelia_tasks`/`n8n_user`/`n8n_password_2025`

3. **修改 `brain/src/migrate.js`** — standalone 模式改为从 `db-config.js` 读取

4. **修改 `brain/src/selfcheck.js`** — standalone 模式改为从 `db-config.js` 读取

5. **修改 4 个测试文件** — 改为从 `db-config.js` 读取连接参数
   - `blocks.test.js`
   - `intent.test.js`
   - `planner.test.js`
   - `resolve-repo-path.test.js`

### 不做的事

- 不改 env var 名称（保持 DB_HOST/DB_PORT/DB_NAME/DB_USER/DB_PASSWORD）
- 不引入 DATABASE_URL（当前架构不需要）
- 不改连接池参数（不在此 PR 范围）

## 成功标准

1. `db-config.js` 是默认值的唯一来源
2. 所有 6 处重复的硬编码默认值被消除
3. 现有测试全部通过（无回归）
4. Brain 容器正常启动（selfcheck 通过）
