## PRD - Cecelia Input Gateway MVP

**需求来源**: "补上系统缺失的'丘脑'——统一输入网关，让 Cecelia 真正自驱动"

**问题诊断**:
当前系统输入源散乱（Claude Code、Notion CRD、n8n、Webhook、手动命令），每个都是独立触发，导致：
- 无法统一管理和排队
- 无法自动发现问题并处理
- 大模型被迫当"网关"，无法自驱动

**功能描述**:
创建 Cecelia Input Gateway 系统（丘脑），包含 5 个核心组件：

1. **Gateway（统一入口）** - 所有输入源汇总到这里
   - 接收标准化任务格式：`{taskId, source, intent, payload, priority}`
   - 支持多种输入源：CloudCode、Notion、n8n、Webhook、CLI
   - 写入 Queue

2. **Queue（任务队列）** - 任务排队系统
   - 存储格式：`queue/queue.jsonl`（后期可升级为 SQLite）
   - 支持优先级排序（P0 > P1 > P2）

3. **Worker（工作器）** - 消费队列并执行
   - 从 Queue 读取任务
   - 根据 `intent` 调用对应的执行器（CloudCode 无头、Orchestrator、Skill）
   - 产出 Evidence + Summary
   - 更新 State

4. **State（状态机）** - 系统状态追踪
   - 存储格式：`state/state.json`
   - 记录：最后运行、队列长度、系统健康度

5. **Heartbeat（自主监控）** - 定时检查并自动入队
   - 每 5 分钟检查系统状态
   - 发现异常 → 自动生成任务并入队
   - 如果队列非空 → 自动启动 Worker

**架构原则**:
- Gateway = 感官（所有输入的唯一入口）
- Queue = 神经系统（排队）
- Worker = 肌肉（CloudCode 无头 + Orchestrator）
- State = 血液循环（状态流转）
- Heartbeat = 自主神经（自动触发）
- 大模型 = 大脑（只在需要时介入，不常驻）

**涉及文件**:
- gateway/gateway.sh（新建）- HTTP endpoint 或 CLI 入口
- gateway/task-schema.json（新建）- 任务格式定义
- queue/queue.jsonl（新建）- 任务队列
- worker/worker.sh（新建）- 工作器
- state/state.json（新建）- 状态文件
- heartbeat/heartbeat.sh（新建）- 自主监控脚本

**成功标准**:
- [ ] Gateway 可接收来自多个源的任务（标准化格式）
- [ ] Queue 可存储和读取任务（支持优先级）
- [ ] Worker 可消费队列并调用 CloudCode 无头/Orchestrator
- [ ] State 可追踪系统状态（最后运行、队列长度）
- [ ] Heartbeat 可定时检查并自动入队任务
- [ ] 端到端测试：从任意输入源 → Gateway → Queue → Worker → Evidence
- [ ] 演示：手动触发 + n8n 触发 + Heartbeat 自动触发，三种方式都能正常工作
