---
id: multi-minimax-cred
version: 1.0.0
created: 2026-02-24
updated: 2026-02-24
changelog:
  - 1.0.0: 初始版本
---
# PRD: 多账户 MiniMax 凭据选择 + 修复 EROFS

## 功能描述

### 问题 1: EROFS - workers.config.json 只读
Brain 容器把 workflows/ 挂载为 `:ro`，PUT /staff/workers/:workerId 写文件时报 EROFS。
修复：在 docker-compose.yml 中为 workers.config.json 单独加 `:rw` 挂载覆盖。

### 问题 2: 支持多个 MiniMax 账户
用户有两个 MiniMax Cloud Code 账户。cecelia-run 硬编码读 `/home/xx/.credentials/minimax.json`，无法选择账户。

修复：
- workers.config.json 给每个 worker 加可选 `credentials_file` 字段
- PUT /staff/workers/:workerId 保存 credentials_file（同时写 worker 和 model_map.minimax_credentials）
- GET /staff 返回 credentials_file（从 model_map.minimax_credentials 或 worker.credentials_file 读取）
- executor.js 新增 getMinimaxCredentialsForTask()，读取并注入 CECELIA_MINIMAX_CREDENTIALS 到 extraEnv
- cecelia-run 使用 ${CECELIA_MINIMAX_CREDENTIALS:-minimax}.json 加载凭据（默认 minimax）
- 前端 WorkerPanel 当 provider=minimax 时显示账户下拉（minimax/minimax2）
- 前端 staffApi.ts 增加 credentials_file 字段定义

## 成功标准
- workers.config.json 可以被 Brain 容器写入（无 EROFS）
- 选择 minimax provider 时前端可选 credentials 账户
- executor.js 传递 CECELIA_MINIMAX_CREDENTIALS 到 cecelia-run
- cecelia-run 使用指定 credentials 文件（默认 minimax）
- 测试通过，TypeScript 类型检查通过
