---
id: dod-proactive-greeting
version: 1.0.0
created: 2026-02-26
updated: 2026-02-26
changelog:
  - 1.0.0: 初始版本
---

# DoD: Cecelia 主动打招呼

## 验收清单

- [ ] **D1: 后端 greet.js 模块** — 生成情境化问候
  - Test: `packages/brain/src/__tests__/greet.test.js` — generateGreeting 返回含 message/type 的对象；冷却期内返回 null

- [ ] **D2: 后端 POST /api/brain/greet 端点** — 接收用户在线信号
  - Test: `packages/brain/src/__tests__/greet.test.js` — POST 返回 200 且触发 WebSocket 广播；重复请求返回 cooldown 状态

- [ ] **D3: 后端更新 user_last_seen** — greet 时自动记录用户在线
  - Test: `packages/brain/src/__tests__/greet.test.js` — greet 后 working_memory.user_last_seen 被更新

- [ ] **D4: 前端页面加载时自动调用 greet** — CeceliaPage mount 时 POST /api/brain/greet
  - Test: 代码审查 — useEffect 中有 fetch('/api/brain/greet', { method: 'POST' })

- [ ] **D5: VoiceCard 通过 WS 接收问候** — 复用现有 DESIRE_EXPRESSED 通道
  - Test: 端到端验证 — 打开页面 → VoiceCard 从静态简报切换为 LLM 生成的问候
