---
id: prd-cp-02212100-perf-observability
version: 1.0.0
created: 2026-02-21
updated: 2026-02-21
changelog:
  - 1.0.0: 初始版本
---

# PRD：性能优化与可观测性增强

## 背景

当前 Cecelia Brain 存在以下问题：
1. exploratory 任务使用 Sonnet，成本较高，实际上 Haiku 足够完成调研型任务
2. max_concurrent 无法通过环境变量控制，无法在不改代码的情况下降低并发
3. 缺乏 CPU/内存/进程数的持续记录，无法事后分析性能趋势
4. 缺乏 Session 时长追踪，无法精确知道从 cap 重置到 cap 触发之间经历了多少时间

## 功能描述

D1：exploratory 任务改用 Haiku（节省 3x token）
D2：MAX_SEATS 支持通过 CECELIA_MAX_SEATS 环境变量覆盖（docker-compose 设为 6）
D3：monitor-loop 每次 cycle 记录一次 resource_snapshot 到 cecelia_events
D4：executor 追踪 Session 开始/结束时间，提供 GET /api/brain/session/stats API

## 范围

- brain/src/executor.js（D1、D2、D4）
- brain/src/monitor-loop.js（D3）
- brain/src/routes.js（D4 API 端点）
- docker-compose.yml（D2 环境变量）

## 版本号

feat → v1.55.0 → v1.56.0（minor bump）
