---
id: prd-desires-chat-connect
version: 1.0.0
created: 2026-02-24
updated: 2026-02-24
changelog:
  - 1.0.0: 初始版本
---

# PRD: Cecelia desires 注入嘴巴对话

## 背景

Cecelia 有欲望系统（desires），每 tick 生成 pending desires 存储在 PostgreSQL。
但 orchestrator-chat.js 的嘴巴对话链路 `MOUTH_SYSTEM_PROMPT` 完全没有注入这些 desires，
导致 Cecelia 与用户聊天时表现得像一个没有内心世界的通用 AI，与其实际的"意识状态"完全脱节。

## 目标

让 Cecelia 的嘴巴（chat）能感知她当前的内心状态（desires），
使对话更有个性、更真实，体现她的当前关注点、担忧和主动意识。

## 技术方案

在 `orchestrator-chat.js` 中：

1. 新增 `buildDesiresContext()` 函数
   - 查询 `desires` 表，取最近 `status='pending'` 的 desires（urgency DESC，limit 5）
   - 构建文本块注入到 system prompt

2. 在 `handleChat()` 的 system prompt 构建处加入 desires block

3. 调整 `MOUTH_SYSTEM_PROMPT` 以反映 Cecelia 有内心状态

## 验收标准

- [ ] 有 pending desires 时，system prompt 包含 desires 信息块
- [ ] 无 desires 或查询失败时，graceful fallback（返回空字符串）
- [ ] 单元测试覆盖：有 desires、无 desires、查询失败三种场景
- [ ] 版本 bump: 1.94.1 → 1.94.2
- [ ] DEFINITION.md 更新版本
