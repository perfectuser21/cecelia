---
id: prd-cp-02211500-project-closer
version: 1.0.0
created: 2026-02-21
updated: 2026-02-21
changelog:
  - 1.0.0: 初始版本
---

## PRD - Project 闭环检查器 + CLAUDE.md 概念清理

**需求来源**: 用户任务，两个子任务合并为一个 PR

**功能描述**:
1. 在 brain/src/initiative-closer.js 中新增 checkProjectCompletion(pool) 函数
   - 查所有 active 的 Project（type='project', status='active'）
   - 对每个 Project，检查其下所有 Initiative 是否都已 completed
   - 若满足条件（有 initiative 且全部完成），则关闭该 Project
   - 写入 cecelia_events 事件
   - 返回关闭的 project 数量

2. 集成到 tick.js Section 0.9（在 checkInitiativeCompletion 之后）

3. 清理 /home/xx/.claude/CLAUDE.md 中 "Project = Repository" 的错误概念
   - 将层级描述修正为 KR → Project → Initiative → Task 结构
   - 删除 "Project (项目 = Repository)" 等误导描述

4. 更新 DEFINITION.md 同步

**涉及文件**:
- brain/src/initiative-closer.js（新增 checkProjectCompletion 函数）
- brain/src/tick.js（新增 Section 0.9 集成调用）
- brain/src/__tests__/initiative-completion.test.js（追加 P1-P4 测试）
- /home/xx/.claude/CLAUDE.md（清理错误概念）
- DEFINITION.md（同步更新）

**成功标准**:
- D1: checkProjectCompletion 函数实现并正确查询数据库
- D2: tick.js Section 0.9 集成
- D3: 测试 P1-P4 通过
- D4: 全量测试通过（npm test）
- D5: CLAUDE.md 中 Project=Repository 概念已清理
- D6: DEFINITION.md 同步更新

**非目标**:
- 不修改 checkInitiativeCompletion 现有逻辑
- 不涉及 KR 级别的闭环检查
- 不修改数据库 schema
