---
id: prd-dialogue-decision-voicecard-fix
version: 1.0.0
created: 2026-02-26
updated: 2026-02-26
changelog:
  - 1.0.0: 初始版本
---

# PRD: 对话式决策 + VoiceCard 智能简报

## 背景

PR #25 实现了 VoiceCard / DecisionInbox / StatusBar 三组件，但用户反馈两个致命问题：

1. **VoiceCard 大部分时间空白** — desire 管道依赖反思累积器达到 30 才触发（10-30 分钟），Cecelia 几乎不"说话"
2. **DecisionInbox 只有"确认"按钮** — 用户原话："那点确认你不就自己可以发吗" —— 纯确认 = 系统应该自己做。用户需要表达想法和意见的入口

## 核心需求

### 需求 1: VoiceCard 永远有内容

VoiceCard 不应依赖稀少的 desire 数据，而应**永远展示有意义的内容**：

| 优先级 | 数据源 | 内容 |
|--------|--------|------|
| P0 | desire:expressed | Cecelia 主动表达（有就用） |
| P1 | 智能简报 | 今日任务进展、完成数、排队数、正在执行 |
| P2 | 反刍洞察 | 最近的反刍/反思结论 |
| P3 | 时间问候 | 基于时段的问候 + 一句话状态 |

**规则**：有 desire 优先用 desire，没有就降级到智能简报，永远不空。

### 需求 2: DecisionInbox 对话式决策

改造为**对话式决策**，而非一键确认：

- 每个决策项展开后有**文字输入框**，用户写想法/意见
- 用户写完点"发送" → 意见作为 context 发给 Cecelia → Cecelia 决策后执行
- **不需要用户决策的东西**（安全动作：retry/skip/reprioritize），系统自动处理，不进 inbox
- 只有**真正需要人类判断**的决策才出现在 inbox

### 需求 3: 后端支持

- 新增 `POST /api/brain/desires/:id/respond` — 接收用户对 desire 的回复（意见文字）
- 修改 briefing API — 返回更丰富的简报数据（任务统计、最近完成、正在执行）

## 成功标准

1. 打开页面 VoiceCard 永远有内容（不依赖 desire 管道）
2. DecisionInbox 支持文字输入表达意见
3. 安全动作不出现在 DecisionInbox
4. 所有测试通过 + 前端构建成功

## 技术约束

- 不修改 desire 核心管道（accumulator 阈值等）
- 利用已有 API：/status/full, /desires, /desires/stats, /inner-life
- 前端改动限于 VoiceCard.tsx, DecisionInbox.tsx, CeceliaPage.tsx
