import{r,j as e,R as u,a8 as d,B as k,D as E,a9 as x,A as T,n as R,aE as O,Z as g,e as L}from"./index-BhHU9tw7.js";function A(){var o,h,b,j,N,p;const[s,f]=r.useState(null),[a,v]=r.useState(null),[w,y]=r.useState(!0),[i,n]=r.useState(null),[m,_]=r.useState(null),c=r.useCallback(async()=>{try{const[t,l]=await Promise.all([fetch("/api/brain/status"),fetch("/api/orchestrator/health")]);if(!t.ok)throw new Error("Failed to fetch brain status");const C=await t.json();if(f(C),l.ok){const D=await l.json();v(D)}_(new Date),n(null)}catch(t){n(t instanceof Error?t.message:"Unknown error")}finally{y(!1)}},[]);r.useEffect(()=>{c();const t=setInterval(c,3e4);return()=>clearInterval(t)},[c]);const S=t=>new Date(t).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});return w?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(u,{className:"w-8 h-8 animate-spin text-slate-400"})}):i?e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3 text-red-600 dark:text-red-400",children:[e.jsx(d,{className:"w-6 h-6"}),e.jsxs("span",{children:["Error: ",i]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl",children:e.jsx(k,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Brain Dashboard"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"AI Decision Transparency"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[m&&e.jsxs("span",{className:"text-xs text-slate-400",children:["Last: ",m.toLocaleTimeString("zh-CN")]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(u,{className:"w-5 h-5 text-slate-500"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(E,{className:"w-5 h-5 text-cyan-500"}),e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Orchestrator"})]}),a?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Status"}),e.jsxs("span",{className:`flex items-center gap-1.5 text-sm ${a.status==="healthy"?"text-emerald-500":"text-red-500"}`,children:[a.status==="healthy"?e.jsx(x,{className:"w-4 h-4"}):e.jsx(d,{className:"w-4 h-4"}),a.status]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Indexed Chunks"}),e.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-white",children:a.indexed_chunks})]}),((o=a.layer2_state)==null?void 0:o.current_focus)&&e.jsx("div",{className:"mt-3 p-2 bg-cyan-50 dark:bg-cyan-900/20 rounded-lg",children:e.jsxs("p",{className:"text-xs text-cyan-600 dark:text-cyan-400",children:["Focus: ",a.layer2_state.current_focus]})})]}):e.jsx("p",{className:"text-sm text-slate-400",children:"Not connected"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(T,{className:"w-5 h-5 text-emerald-500"}),e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"System Health"})]}),s!=null&&s.system_health?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"N8N"}),e.jsxs("span",{className:`flex items-center gap-1.5 text-sm ${s.system_health.n8n_ok?"text-emerald-500":"text-red-500"}`,children:[s.system_health.n8n_ok?e.jsx(x,{className:"w-4 h-4"}):e.jsx(d,{className:"w-4 h-4"}),s.system_health.n8n_ok?"OK":"Error"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Task System"}),e.jsxs("span",{className:`flex items-center gap-1.5 text-sm ${s.system_health.task_system_ok?"text-emerald-500":"text-red-500"}`,children:[s.system_health.task_system_ok?e.jsx(x,{className:"w-4 h-4"}):e.jsx(d,{className:"w-4 h-4"}),s.system_health.task_system_ok?"OK":"Error"]})]}),s.system_health.n8n_failures_1h>0&&e.jsxs("div",{className:"text-xs text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-900/20 px-2 py-1 rounded",children:[s.system_health.n8n_failures_1h," failures in last hour"]})]}):e.jsx("p",{className:"text-sm text-slate-400",children:"No health data"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(R,{className:"w-5 h-5 text-blue-500"}),e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Current Focus"})]}),(h=s==null?void 0:s.memory)!=null&&h.current_focus?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Project: "}),e.jsx("span",{className:"text-slate-900 dark:text-white font-medium",children:s.memory.current_focus.project||"-"})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Goal: "}),e.jsx("span",{className:"text-slate-900 dark:text-white font-medium",children:s.memory.current_focus.goal||"-"})]}),((b=s.memory.today_intent)==null?void 0:b.description)&&e.jsx("div",{className:"mt-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:["Today: ",s.memory.today_intent.description]})})]}):e.jsx("p",{className:"text-sm text-slate-400",children:"No focus set"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(O,{className:"w-5 h-5 text-violet-500"}),e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Task Stats"})]}),(j=s==null?void 0:s.tasks)!=null&&j.stats?e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"text-center p-2 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:s.tasks.stats.open_p0}),e.jsx("div",{className:"text-xs text-slate-500",children:"P0 Open"})]}),e.jsxs("div",{className:"text-center p-2 bg-amber-50 dark:bg-amber-900/20 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600 dark:text-amber-400",children:s.tasks.stats.open_p1}),e.jsx("div",{className:"text-xs text-slate-500",children:"P1 Open"})]}),e.jsxs("div",{className:"text-center p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:s.tasks.stats.in_progress}),e.jsx("div",{className:"text-xs text-slate-500",children:"In Progress"})]}),e.jsxs("div",{className:"text-center p-2 bg-slate-50 dark:bg-slate-700/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-600 dark:text-slate-300",children:s.tasks.stats.queued}),e.jsx("div",{className:"text-xs text-slate-500",children:"Queued"})]})]}):e.jsx("p",{className:"text-sm text-slate-400",children:"No task data"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 p-5 border-b border-slate-200 dark:border-slate-700",children:[e.jsx(g,{className:"w-5 h-5 text-amber-500"}),e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Recent Decisions"})]}),e.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:s!=null&&s.recent_decisions&&s.recent_decisions.length>0?s.recent_decisions.map((t,l)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400 w-20",children:[e.jsx(L,{className:"w-4 h-4"}),S(t.ts)]}),e.jsx("div",{className:"flex-1",children:e.jsx("code",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded text-sm text-slate-700 dark:text-slate-300",children:t.action})}),e.jsxs("div",{className:`flex items-center gap-1.5 text-sm ${t.status==="success"?"text-emerald-500":"text-red-500"}`,children:[t.status==="success"?e.jsx(x,{className:"w-4 h-4"}):e.jsx(d,{className:"w-4 h-4"}),t.status]})]},l)):e.jsx("div",{className:"p-8 text-center text-slate-400",children:"No recent decisions"})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 p-5 border-b border-slate-200 dark:border-slate-700",children:[e.jsx(k,{className:"w-5 h-5 text-purple-500"}),e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Working Memory"})]}),e.jsx("div",{className:"p-5",children:s!=null&&s.memory?e.jsx("pre",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-lg p-4 overflow-x-auto text-sm text-slate-700 dark:text-slate-300",children:JSON.stringify(s.memory,null,2)}):e.jsx("p",{className:"text-sm text-slate-400",children:"No memory data"})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 p-5 border-b border-slate-200 dark:border-slate-700",children:[e.jsx(g,{className:"w-5 h-5 text-emerald-500"}),e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Allowed Actions"}),e.jsxs("span",{className:"text-xs text-slate-400 ml-auto",children:["Policy v",(s==null?void 0:s.policy_version)||0]})]}),e.jsx("div",{className:"p-5",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:(p=(N=s==null?void 0:s.policy_rules)==null?void 0:N.allowed_actions)==null?void 0:p.map(t=>e.jsx("span",{className:"px-3 py-1.5 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 rounded-full text-sm font-medium",children:t},t))})})]})]})}export{A as default};
