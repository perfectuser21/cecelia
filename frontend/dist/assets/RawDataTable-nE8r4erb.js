import{r as n,j as e,R as S,x as A,W as B,aC as W,C as R}from"./index-BhHU9tw7.js";const $="",y={douyin:{name:"æŠ–éŸ³",color:"#000000"},kuaishou:{name:"å¿«æ‰‹",color:"#FF6600"},xiaohongshu:{name:"å°çº¢ä¹¦",color:"#FF2442"},toutiao:{name:"ä»Šæ—¥å¤´æ¡",color:"#D22828"},weibo:{name:"å¾®åš",color:"#E6162D"},channels:{name:"è§†é¢‘å·",color:"#07C160"},zhihu:{name:"çŸ¥ä¹",color:"#0084FF"},bilibili:{name:"Bç«™",color:"#FB7299"}},b=[{key:"id",label:"ID",width:"80px",type:"id"},{key:"platform",label:"å¹³å°",width:"100px",type:"text"},{key:"content_type",label:"å†…å®¹ç±»å‹",width:"100px",type:"text"},{key:"title",label:"æ ‡é¢˜",width:"200px",type:"text"},{key:"publish_time",label:"å‘å¸ƒæ—¶é—´",width:"160px",type:"datetime"},{key:"status",label:"çŠ¶æ€",width:"80px",type:"text"},{key:"latest_views",label:"æ’­æ”¾/é˜…è¯»",width:"100px",type:"number"},{key:"latest_likes",label:"ç‚¹èµ",width:"80px",type:"number"},{key:"latest_comments",label:"è¯„è®º",width:"80px",type:"number"},{key:"latest_shares",label:"åˆ†äº«",width:"80px",type:"number"},{key:"latest_favorites",label:"æ”¶è—",width:"80px",type:"number"},{key:"latest_follower_gain",label:"æ¶¨ç²‰",width:"80px",type:"number"},{key:"completion_rate",label:"å®Œæ’­ç‡%",width:"90px",type:"percent",platforms:["douyin","kuaishou","channels"]},{key:"completion_rate_5s",label:"5så®Œæ’­%",width:"90px",type:"percent",platforms:["douyin","kuaishou"]},{key:"click_rate",label:"ç‚¹å‡»ç‡%",width:"90px",type:"percent",platforms:["toutiao","weibo"]},{key:"bounce_rate",label:"è·³å‡ºç‡%",width:"90px",type:"percent",platforms:["toutiao"]},{key:"avg_play_duration",label:"å¹³å‡æ—¶é•¿",width:"100px",type:"text",platforms:["douyin","kuaishou","channels"]},{key:"profile_visits",label:"ä¸»é¡µè®¿é—®",width:"90px",type:"number",platforms:["douyin","xiaohongshu"]},{key:"account_name",label:"è´¦å·åç§°",width:"120px",type:"text"},{key:"account_id",label:"è´¦å·ID",width:"120px",type:"text"},{key:"content_type_normalized",label:"ç±»å‹æ ‡å‡†åŒ–",width:"100px",type:"text"},{key:"content_group_id",label:"å†…å®¹ç»„ID",width:"100px",type:"number"},{key:"content_id",label:"å†…å®¹ID",width:"120px",type:"text"},{key:"raw_data_id",label:"åŸå§‹æ•°æ®ID",width:"100px",type:"number"},{key:"detection_method",label:"æ£€æµ‹æ–¹æ³•",width:"120px",type:"text"},{key:"created_at",label:"åˆ›å»ºæ—¶é—´",width:"160px",type:"datetime"},{key:"updated_at",label:"æ›´æ–°æ—¶é—´",width:"160px",type:"datetime"}],P=a=>{if(a==null)return"-";const l=typeof a=="string"?parseInt(a):a;return isNaN(l)?"-":l>=1e4?(l/1e4).toFixed(1)+"w":l>=1e3?(l/1e3).toFixed(1)+"k":l.toLocaleString()},V=a=>a?new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",F=a=>a?new Date(a).toLocaleDateString("zh-CN"):"-";function U(){const[a,l]=n.useState([]),[g,f]=n.useState(!0),[h,I]=n.useState("publish_time"),[m,w]=n.useState("desc"),[i,j]=n.useState(""),[o,v]=n.useState(""),[c,N]=n.useState(""),[d,k]=n.useState("");n.useEffect(()=>{_()},[]);const _=async()=>{f(!0);try{const r=await(await fetch(`${$}/api/media/platform-data?limit=1000`)).json();r.success&&l(r.data)}catch(t){console.error("Failed to fetch data:",t)}finally{f(!1)}},u=a.filter(t=>!(i&&t.platform!==i||o&&t.content_type!==o||c&&F(t.publish_time)!==c||d&&!t.title.toLowerCase().includes(d.toLowerCase()))).sort((t,r)=>{const s=t[h],x=r[h];if(s===x)return 0;const p=s>x?1:-1;return m==="asc"?p:-p}),T=t=>{h===t?w(m==="asc"?"desc":"asc"):(I(t),w("desc"))},E=({field:t})=>h!==t?null:m==="asc"?e.jsx(W,{className:"w-3 h-3"}):e.jsx(R,{className:"w-3 h-3"}),C=Array.from(new Set(a.map(t=>t.platform))),L=Array.from(new Set(a.map(t=>t.content_type))),D=Array.from(new Set(a.map(t=>F(t.publish_time)))).sort((t,r)=>r.localeCompare(t)),z=(t,r)=>{const s=t[r.key];if(r.platforms&&!r.platforms.includes(t.platform))return e.jsx("span",{className:"text-gray-300",children:"-"});switch(r.type){case"id":return s||"-";case"number":return P(s);case"percent":return s?`${s}%`:"-";case"datetime":return V(s);case"text":default:return s||"-"}};return g?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(S,{className:"w-8 h-8 animate-spin text-gray-400"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"åŸå§‹æ•°æ®è¡¨"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"æ•°æ®åº“å®Œæ•´å¯¼å‡º Â· æ‰€æœ‰å­—æ®µæ¨ªå‘å±•å¼€ Â· ç±»ä¼¼ Excel"})]}),e.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(S,{className:`w-4 h-4 ${g?"animate-spin":""}`}),"åˆ·æ–°"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"æ€»è®°å½•æ•°"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:a.length})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"ç­›é€‰å"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:u.length})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"å¹³å°æ•°"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C.length})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"æ—¥æœŸæ•°"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:D.length})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"ç­›é€‰ï¼š"})]}),e.jsxs("select",{value:c,onChange:t=>N(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 min-w-[150px]",children:[e.jsx("option",{value:"",children:"å…¨éƒ¨æ—¥æœŸ"}),D.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:i,onChange:t=>j(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"å…¨éƒ¨å¹³å°"}),C.map(t=>{var r;return e.jsx("option",{value:t,children:((r=y[t])==null?void 0:r.name)||t},t)})]}),e.jsxs("select",{value:o,onChange:t=>v(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"å…¨éƒ¨ç±»å‹"}),L.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("div",{className:"flex-1 min-w-[200px] max-w-[300px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"æœç´¢æ ‡é¢˜...",value:d,onChange:t=>k(t.target.value),className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),(i||o||c||d)&&e.jsx("button",{onClick:()=>{j(""),v(""),N(""),k("")},className:"text-sm text-blue-600 hover:text-blue-700",children:"æ¸…é™¤ç­›é€‰"})]})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800",children:[e.jsx("div",{className:"font-medium mb-1",children:"ğŸ’¡ å­—æ®µè¯´æ˜ï¼š"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-gray-400",children:'ç°è‰² "-"'})," = è¯¥å¹³å°ä¸æ”¯æŒæ­¤å­—æ®µï¼ˆå¦‚ï¼šå°çº¢ä¹¦æ²¡æœ‰5så®Œæ’­ç‡ï¼‰"]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-gray-900",children:'é»‘è‰² "-"'})," = è¯¥å­—æ®µæš‚æ— æ•°æ®"]}),e.jsx("li",{children:"å®Œæ’­ç‡ã€5så®Œæ’­ç‡ï¼šæŠ–éŸ³ã€å¿«æ‰‹ç‰¹æœ‰"}),e.jsx("li",{children:"ç‚¹å‡»ç‡ã€è·³å‡ºç‡ï¼šä»Šæ—¥å¤´æ¡ç‰¹æœ‰"}),e.jsx("li",{children:"ä¸»é¡µè®¿é—®ï¼šæŠ–éŸ³ã€å°çº¢ä¹¦ç‰¹æœ‰"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[600px]",style:{scrollbarWidth:"thin"},children:e.jsxs("table",{className:"w-full text-xs border-collapse min-w-max",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:e.jsx("tr",{children:b.map(t=>e.jsx("th",{className:"px-2 py-2 text-left border-r border-gray-200 last:border-r-0",style:{minWidth:t.width},children:e.jsxs("button",{onClick:()=>T(t.key),className:"flex items-center gap-1 font-medium text-gray-700 hover:text-gray-900 whitespace-nowrap w-full",children:[t.label,e.jsx(E,{field:t.key})]})},t.key))})}),e.jsx("tbody",{children:u.map((t,r)=>e.jsx("tr",{className:`border-b border-gray-100 hover:bg-blue-50 ${r%2===0?"bg-white":"bg-gray-50"}`,children:b.map(s=>{var x,p;return e.jsx("td",{className:"px-2 py-2 border-r border-gray-200 last:border-r-0 text-gray-900",style:{minWidth:s.width,maxWidth:s.key==="title"?s.width:"none"},children:s.key==="platform"?e.jsx("span",{className:"inline-block px-2 py-0.5 rounded text-white text-xs font-medium whitespace-nowrap",style:{backgroundColor:((x=y[t.platform])==null?void 0:x.color)||"#999"},children:((p=y[t.platform])==null?void 0:p.name)||t.platform}):s.key==="title"?e.jsx("div",{className:"truncate overflow-hidden text-ellipsis whitespace-nowrap",title:t.title,children:t.title}):e.jsx("div",{className:"whitespace-nowrap",children:z(t,s)})},s.key)})},t.id))})]})}),u.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:d||i||o||c?"æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®":"æš‚æ— æ•°æ®"})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["æ˜¾ç¤º ",u.length," / ",a.length," æ¡è®°å½• Â· å…± ",b.length," ä¸ªå­—æ®µ Â· å¯æ¨ªå‘æ»šåŠ¨æŸ¥çœ‹æ‰€æœ‰åˆ—"]})]})}export{U as default};
