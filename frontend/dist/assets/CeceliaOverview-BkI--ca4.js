import{j as e,aR as H,r as c,b6 as Q,a4 as V,A as E,C as Z,$ as O,aQ as X,R as _,bx as Y,e as A,a8 as S,a9 as q,by as F,ag as J,bz as K,ak as M,m as W,Z as ee,v as se,U as te,aY as ae,b2 as le}from"./index-BhHU9tw7.js";import{f as re,a as ne}from"./agents.api-59sW8kJ7.js";import{a as u}from"./client-DYAnEeaj.js";import"./index-B9ygI19o.js";const ie={getGoal:s=>u.get(`/brain/goals/${s}`),getGoals:()=>u.get("/tasks/goals"),updateGoal:(s,a)=>u.put("/brain/action/update-goal",{goal_id:s,...a}),getQuestions:s=>u.get(`/brain/okr/${s}/questions`),addQuestion:(s,a)=>u.post(`/brain/okr/${s}/question`,{question:a}),answerQuestion:(s,a,l)=>u.put(`/brain/okr/${s}/answer`,{question_id:a,answer:l}),getOkrStatuses:()=>u.get("/brain/okr/statuses"),getDailyReports:(s="today",a="all")=>u.get("/brain/daily-reports",{params:{date:s,type:a}}),getDailyReportByDate:s=>u.get(`/brain/daily-reports/${s}`),getDailySummary:s=>u.get(`/brain/daily-reports/${s}/summary`),triggerNightly:()=>u.post("/brain/nightly/trigger"),getReflections:s=>u.get("/brain/reflections",{params:s}),createReflection:s=>u.post("/brain/reflections",s),getTaskTypes:()=>u.get("/brain/task-types"),routeTask:s=>u.post("/brain/route-task",s),getOkrTickStatus:()=>u.get("/brain/okr-tick/status"),triggerOkrTick:()=>u.post("/brain/okr-tick"),getNightlyStatus:()=>u.get("/brain/nightly/status"),getVpsSlots:()=>u.get("/brain/vps-slots"),getExecutionHistory:(s=20)=>u.get("/brain/execution-history",{params:{limit:s}})},ce=[{value:"24h",label:"24时"},{value:"72h",label:"72时"},{value:"7d",label:"7天"}];function de({value:s,onChange:a}){return e.jsx("div",{className:"flex bg-slate-700 rounded-lg p-1",children:ce.map(l=>e.jsx("button",{onClick:()=>a(l.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-all ${s===l.value?"bg-blue-600 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-slate-600"}`,children:l.label},l.value))})}function xe({data:s}){return s.projects.length===0?e.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-12 text-center",children:[e.jsx(H,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"暂无项目数据"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"运行 Cecelia 任务后将显示项目时间线"})]}):e.jsx("div",{className:"space-y-6",children:s.projects.map(a=>e.jsx(oe,{project:a},a.name))})}function oe({project:s}){const[a,l]=c.useState(s.runningCount>0);return e.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("button",{onClick:()=>l(!a),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-slate-700/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl",children:e.jsx(Q,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:s.name}),s.repoUrl&&e.jsx("a",{href:s.repoUrl,target:"_blank",rel:"noopener noreferrer",onClick:n=>n.stopPropagation(),className:"text-gray-500 hover:text-blue-400 transition-colors",children:e.jsx(V,{className:"w-4 h-4"})}),s.runningCount>0&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full bg-blue-900/50 text-blue-400 flex items-center gap-1",children:[e.jsx(E,{className:"w-3 h-3 animate-pulse"}),s.runningCount," 运行中"]})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[s.features.length," Features · ",s.totalRuns," Runs"]})]})]}),a?e.jsx(Z,{className:"w-5 h-5 text-gray-500"}):e.jsx(O,{className:"w-5 h-5 text-gray-500"})]}),a&&e.jsx("div",{className:"border-t border-slate-700 divide-y divide-slate-700/50",children:s.features.map(n=>e.jsx(me,{feature:n},n.name))})]})}function me({feature:s}){const[a,l]=c.useState(s.current||null),n=!!s.current;return e.jsxs("div",{className:`px-6 py-4 ${n?"bg-blue-900/10":""}`,children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(X,{className:`w-4 h-4 ${n?"text-blue-400":"text-cyan-400"}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:s.displayName}),n&&e.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] rounded bg-blue-500/30 text-blue-300 flex items-center gap-1",children:[e.jsx(_,{className:"w-2.5 h-2.5 animate-spin"}),"运行中"]})]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1.5",children:[e.jsx(Y,{className:"w-3 h-3 text-gray-500"}),e.jsx("div",{className:"flex items-center gap-1",children:s.history.map((t,d)=>e.jsxs("button",{onClick:()=>{var r;return l(((r=s.current)==null?void 0:r.id)===t.id?s.current:s.latestRun.id===t.id?s.latestRun:null)},className:`
                      px-1.5 py-0.5 text-[10px] rounded transition-colors
                      ${t.status==="running"?"bg-blue-500/30 text-blue-300":t.status==="completed"?"bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30":t.status==="failed"?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-slate-700/50 text-gray-400 hover:bg-slate-700"}
                    `,title:`v${t.version} - ${t.date} - ${t.branch}`,children:["v",t.version]},t.id))})]})]})]})}),(s.current||a)&&e.jsx(he,{run:s.current||a})]})}function he({run:s}){var n,t;const[a,l]=c.useState(((t=(n=s.checkpoints_detail)==null?void 0:n.find(d=>d.status==="in_progress"))==null?void 0:t.id)||null);return s.checkpoints_detail&&s.checkpoints_detail.length>0?e.jsxs("div",{className:"mt-3 ml-7",children:[s.prd_title&&e.jsxs("div",{className:"mb-3 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"当前: "}),e.jsx("span",{className:"text-white",children:s.prd_title})]}),e.jsx("div",{className:"flex items-start gap-2 overflow-x-auto pb-2",children:s.checkpoints_detail.map((d,r)=>{const b=a===d.id,g=d.status==="in_progress";return e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("button",{onClick:()=>l(b?null:d.id),className:`
                    flex-shrink-0 w-28 p-3 rounded-lg border text-left transition-all
                    ${g?"border-blue-500/50 bg-blue-900/30":d.status==="done"?"border-emerald-500/30 bg-emerald-900/20":d.status==="failed"?"border-red-500/30 bg-red-900/20":"border-slate-600/30 bg-slate-700/30"}
                    hover:scale-105
                  `,children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(ge,{status:d.status}),e.jsx("span",{className:"text-[10px] font-mono text-gray-400",children:d.id})]}),e.jsx("p",{className:"text-xs text-white truncate",title:d.name,children:d.name}),g&&e.jsx("p",{className:"text-[10px] text-blue-400 mt-1",children:"← 当前"})]}),r<s.checkpoints_detail.length-1&&e.jsx("div",{className:"flex items-center h-full pt-6 text-gray-600",children:"→"})]},d.id)})}),a&&e.jsx(ue,{run:s,checkpointId:a})]}):s.steps&&s.steps.length>0?e.jsx("div",{className:"mt-3 ml-7",children:e.jsx(B,{steps:s.steps,currentStep:s.current_step})}):e.jsx("div",{className:"mt-3 ml-7",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-slate-700 rounded-full overflow-hidden max-w-xs",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-cyan-500",style:{width:s.total_checkpoints>0?`${s.completed_checkpoints/s.total_checkpoints*100}%`:"0%"}})}),e.jsxs("span",{className:"text-xs text-gray-400",children:[s.completed_checkpoints,"/",s.total_checkpoints]})]})})}function ue({run:s,checkpointId:a}){var t;const l=(t=s.checkpoints_detail)==null?void 0:t.find(d=>d.id===a),n=(l==null?void 0:l.dev_steps)||s.steps||[];return n.length===0?e.jsx("div",{className:"mt-3 p-3 bg-slate-700/30 rounded-lg text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"暂无步骤详情"})}):e.jsxs("div",{className:"mt-3 p-3 bg-slate-700/30 rounded-lg",children:[e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:[a," Dev 流程"]}),e.jsx(B,{steps:n,currentStep:s.current_step})]})}function B({steps:s,currentStep:a}){return e.jsx("div",{className:"flex flex-wrap gap-1.5",children:s.map(l=>e.jsx("span",{className:`
            px-2 py-1 text-xs rounded-md border transition-colors
            ${l.status==="done"?"bg-emerald-500/20 text-emerald-400 border-emerald-500/30":l.status==="in_progress"?"bg-blue-500/20 text-blue-400 border-blue-500/30 animate-pulse":l.status==="failed"?"bg-red-500/20 text-red-400 border-red-500/30":"bg-slate-700/50 text-gray-500 border-slate-600/30"}
          `,children:l.name},l.id))})}function ge({status:s}){switch(s){case"done":return e.jsx(q,{className:"w-3.5 h-3.5 text-emerald-500"});case"in_progress":return e.jsx(_,{className:"w-3.5 h-3.5 text-blue-500 animate-spin"});case"failed":return e.jsx(S,{className:"w-3.5 h-3.5 text-red-500"});default:return e.jsx(A,{className:"w-3.5 h-3.5 text-gray-500"})}}function pe({slot:s,onClick:a}){const[l,n]=c.useState(!1),t=o=>"bg-blue-100 text-blue-700 border-blue-200",d=o=>{switch(o){case"P0":return"bg-red-100 text-red-700";case"P1":return"bg-orange-100 text-orange-700";case"P2":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}},r=o=>{switch(o){case"short":return"bg-green-100 text-green-700";case"long":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-700"}},b=o=>{try{const w=new Date(o),k=new Date().getTime()-w.getTime(),i=Math.floor(k/6e4),P=Math.floor(k%6e4/1e3);return i>0?`${i}m ${P}s`:`${P}s`}catch{return"N/A"}},g=o=>{try{return`${parseFloat(o).toFixed(1)}%`}catch{return o}},y=o=>o,v=()=>{a&&a(s)},f=!!a;return e.jsxs("div",{className:`
        bg-white rounded-xl border-2 border-gray-200 p-5
        transition-all duration-200
        ${f?"cursor-pointer":""}
        ${l&&f?"shadow-lg border-blue-300 scale-105":"shadow-sm"}
      `,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:v,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-1 truncate",children:s.taskTitle||"Untitled Task"}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full border ${t(s.taskType)}`,children:[e.jsx(F,{className:"w-3 h-3"}),"Running"]}),s.taskPriority&&e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${d(s.taskPriority)}`,children:s.taskPriority}),s.taskType&&e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${r(s.taskType)}`,children:s.taskType})]})]}),f&&e.jsx(O,{className:`w-5 h-5 text-gray-400 flex-shrink-0 transition-transform ${l?"translate-x-1":""}`})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(A,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"Duration:"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.startedAt?b(s.startedAt):"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(J,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"CPU:"}),e.jsx("span",{className:"font-medium text-gray-900",children:g(s.cpu)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(K,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"Memory:"}),e.jsx("span",{className:"font-medium text-gray-900",children:y(s.memory)})]})]}),(s.taskId||s.runId)&&e.jsx("div",{className:"pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.taskId&&e.jsxs("span",{className:"truncate",title:s.taskId,children:["Task: ",s.taskId.substring(0,8)]}),s.runId&&e.jsxs("span",{className:"truncate",title:s.runId,children:["Run: ",s.runId.substring(0,8)]})]})})]})}function je({autoRefresh:s=!0,refreshInterval:a=5e3}){const[l,n]=c.useState([]),[t,d]=c.useState(!0),[r,b]=c.useState(null),[g,y]=c.useState(null),[v,f]=c.useState(!1),o=c.useCallback(async()=>{try{f(!0);const i=await ie.getVpsSlots();i.success?(n(i.slots),b(null),y(new Date)):b("Failed to load execution status")}catch(i){console.error("Failed to load execution status:",i),b(i instanceof Error?i.message:"Unknown error occurred")}finally{d(!1),f(!1)}},[]);c.useEffect(()=>{o()},[o]),c.useEffect(()=>{if(!s)return;const i=setInterval(()=>{o()},a);return()=>clearInterval(i)},[s,a,o]);const w=()=>{v||o()},j=l.filter(i=>i.taskId!==null),k=j.length>0;return t&&!g?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"flex items-center gap-3 text-gray-500",children:[e.jsx(_,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Loading execution status..."})]})}):r&&!g?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"flex items-center gap-3 text-red-600",children:[e.jsx(M,{className:"w-5 h-5"}),e.jsx("span",{children:r})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Execution Status"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[j.length," active task",j.length!==1?"s":""," running"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[g&&e.jsxs("span",{className:"text-sm text-gray-500",children:["Updated ",g.toLocaleTimeString()]}),e.jsxs("button",{onClick:w,disabled:v,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Refresh now",children:[e.jsx(_,{className:`w-4 h-4 ${v?"animate-spin":""}`}),"Refresh"]})]})]}),r&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(M,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-red-900",children:"Error loading data"}),e.jsx("p",{className:"text-sm text-red-700",children:r})]})]}),k?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:j.map(i=>e.jsx(pe,{slot:i},i.pid))}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx(E,{className:"w-12 h-12 text-gray-400 mb-3"}),e.jsx("p",{className:"text-lg font-medium text-gray-600 mb-1",children:"No active tasks"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Tasks will appear here when they start executing"})]})]})}const be="/api/brain";function we(){const[s,a]=c.useState(null),[l,n]=c.useState(null),[t,d]=c.useState(null),[r,b]=c.useState([]),[g,y]=c.useState(!0),[v,f]=c.useState(null),[o,w]=c.useState(null),[j,k]=c.useState("24h"),i=c.useCallback(async()=>{try{const[h,N,G,U]=await Promise.all([re(j),ne(),fetch(`${be}/tick/status`).then(p=>{if(!p.ok)throw new Error(`Brain API failed: ${p.status}`);return p.json()}).catch(p=>(console.warn("Brain API error:",p),null)),fetch("/api/tasks/tasks").then(p=>{if(!p.ok)throw new Error(`Tasks API failed: ${p.status}`);return p.json()}).catch(p=>(console.warn("Tasks API error:",p),[]))]);a(h),n(N),d(G),b(Array.isArray(U)?U:[]),f(null),w(new Date)}catch(h){f(h.message)}finally{y(!1)}},[j]);c.useEffect(()=>{y(!0),i();const h=setInterval(i,3e4);return()=>clearInterval(h)},[i]);const P=h=>{switch(h){case"24h":return"过去 24 小时";case"72h":return"过去 72 小时";case"7d":return"过去 7 天"}},x=r.reduce((h,N)=>(h[N.status]=(h[N.status]||0)+1,h),{queued:0,in_progress:0,completed:0,failed:0,cancelled:0}),$=x.in_progress||0,C=(t==null?void 0:t.max_concurrent)||0,z=C-$,L=r.filter(h=>h.status==="in_progress");if(g&&!s)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(_,{className:"w-8 h-8 text-blue-500 animate-spin"})});if(v&&!s)return e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-xl p-6 text-center",children:[e.jsx(S,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),e.jsxs("p",{className:"text-red-400",children:["加载失败: ",v]}),e.jsx("button",{onClick:i,className:"mt-4 px-4 py-2 bg-red-900/30 text-red-400 rounded-lg hover:bg-red-900/50 transition-colors",children:"重试"})]});const m=s==null?void 0:s.periodStats;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl",children:e.jsx(W,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Cecelia"}),e.jsxs("p",{className:"text-gray-400",children:["无头 Claude Code · ",(l==null?void 0:l.totalProjects)||0," 项目 · ",(l==null?void 0:l.totalFeatures)||0," Features · ",P(j)," ",(m==null?void 0:m.total)||0," 次任务"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(de,{value:j,onChange:k}),o&&e.jsx("span",{className:"text-sm text-gray-500",children:o.toLocaleTimeString("zh-CN")}),e.jsx("button",{onClick:i,disabled:g,className:"p-2 text-gray-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors disabled:opacity-50",children:e.jsx(_,{className:`w-5 h-5 ${g?"animate-spin":""}`})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(T,{icon:e.jsx(E,{className:"w-4 h-4 text-white"}),label:"运行中",value:(m==null?void 0:m.running)||0,color:"from-blue-500 to-cyan-600",animate:m&&m.running>0}),e.jsx(T,{icon:e.jsx(q,{className:"w-4 h-4 text-white"}),label:"成功",value:(m==null?void 0:m.success)||0,color:"from-green-500 to-emerald-600"}),e.jsx(T,{icon:e.jsx(S,{className:"w-4 h-4 text-white"}),label:"失败",value:(m==null?void 0:m.error)||0,color:"from-red-500 to-rose-600"}),e.jsx(T,{icon:e.jsx(ee,{className:"w-4 h-4 text-white"}),label:"总数",value:(m==null?void 0:m.total)||0,color:"from-purple-500 to-violet-600"}),e.jsx(T,{icon:e.jsx(se,{className:"w-4 h-4 text-white"}),label:"成功率",value:`${(m==null?void 0:m.successRate)||0}%`,color:"from-emerald-500 to-teal-600"})]}),e.jsx("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-6",children:e.jsx(je,{autoRefresh:!0,refreshInterval:5e3})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(R,{title:"Seats 配置",icon:e.jsx(te,{className:"w-5 h-5"}),children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(I,{label:"最大并发",value:C}),e.jsx(I,{label:"使用中",value:$,highlight:$>0}),e.jsx(I,{label:"可用",value:z}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-700",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-400",children:"使用率"}),e.jsxs("span",{className:"text-white font-medium",children:[C>0?Math.round($/C*100):0,"%"]})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-cyan-500 h-2 rounded-full transition-all",style:{width:`${C>0?$/C*100:0}%`}})})]})]})}),e.jsx(R,{title:"Tick Loop",icon:e.jsx(A,{className:"w-5 h-5"}),children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t!=null&&t.enabled&&(t!=null&&t.loop_running)?"bg-green-500 animate-pulse":"bg-gray-500"}`}),e.jsx("span",{className:"text-sm text-gray-400",children:t!=null&&t.enabled&&(t!=null&&t.loop_running)?"运行中":"已停止"})]}),e.jsx(I,{label:"循环间隔",value:`${t!=null&&t.loop_interval_ms?Math.round(t.loop_interval_ms/6e4):0} 分钟`}),e.jsx(I,{label:"今日动作",value:(t==null?void 0:t.actions_today)||0,highlight:t&&t.actions_today>0}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[e.jsxs("div",{children:["上次: ",t!=null&&t.last_tick?new Date(t.last_tick).toLocaleTimeString("zh-CN"):"-"]}),e.jsxs("div",{children:["下次: ",t!=null&&t.next_tick?new Date(t.next_tick).toLocaleTimeString("zh-CN"):"-"]})]})]})}),e.jsx(R,{title:"熔断器",icon:e.jsx(ae,{className:"w-5 h-5"}),children:e.jsxs("div",{className:"space-y-2",children:[(t==null?void 0:t.circuit_breakers)&&Object.entries(t.circuit_breakers).map(([h,N])=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-900/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-white font-medium",children:h}),e.jsxs("div",{className:"text-xs text-gray-500",children:["失败: ",N.failures]})]}),e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${N.state==="CLOSED"?"bg-green-500/20 text-green-400":N.state==="OPEN"?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"}`,children:N.state})]},h)),!(t!=null&&t.circuit_breakers)&&e.jsx("div",{className:"text-sm text-gray-500",children:"暂无数据"})]})})]}),e.jsxs(R,{title:"任务队列统计",icon:e.jsx(le,{className:"w-5 h-5"}),children:[e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsx(D,{label:"队列中",value:x.queued,color:"text-yellow-400"}),e.jsx(D,{label:"执行中",value:x.in_progress,color:"text-blue-400"}),e.jsx(D,{label:"已完成",value:x.completed,color:"text-green-400"}),e.jsx(D,{label:"失败",value:x.failed,color:"text-red-400"}),e.jsx(D,{label:"取消",value:x.cancelled,color:"text-gray-400"})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-700",children:e.jsxs("div",{className:"w-full bg-slate-700 rounded-full h-3 flex overflow-hidden",children:[x.queued>0&&e.jsx("div",{className:"bg-yellow-500",style:{width:`${r.length>0?x.queued/r.length*100:0}%`},title:`队列中: ${x.queued}`}),x.in_progress>0&&e.jsx("div",{className:"bg-blue-500",style:{width:`${r.length>0?x.in_progress/r.length*100:0}%`},title:`执行中: ${x.in_progress}`}),x.completed>0&&e.jsx("div",{className:"bg-green-500",style:{width:`${r.length>0?x.completed/r.length*100:0}%`},title:`已完成: ${x.completed}`}),x.failed>0&&e.jsx("div",{className:"bg-red-500",style:{width:`${r.length>0?x.failed/r.length*100:0}%`},title:`失败: ${x.failed}`}),x.cancelled>0&&e.jsx("div",{className:"bg-gray-500",style:{width:`${r.length>0?x.cancelled/r.length*100:0}%`},title:`取消: ${x.cancelled}`})]})})]}),L.length>0&&e.jsx(R,{title:"当前正在执行",icon:e.jsx(F,{className:"w-5 h-5"}),children:e.jsx("div",{className:"space-y-2",children:L.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-white font-medium",children:h.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:["开始于 ",new Date(h.created_at).toLocaleString("zh-CN")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-blue-400",children:"运行中"})]})]},h.id))})}),l&&e.jsx(xe,{data:l})]})}function T({icon:s,label:a,value:l,color:n,animate:t}){return e.jsx("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-9 h-9 bg-gradient-to-br ${n} rounded-xl flex items-center justify-center shadow-lg ${t?"animate-pulse":""}`,children:s}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400",children:a}),e.jsx("div",{className:"text-xl font-bold text-white",children:l})]})]})})}function R({title:s,icon:a,children:l}){return e.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"text-violet-400",children:a}),e.jsx("h3",{className:"text-sm font-semibold text-white",children:s})]}),l]})}function I({label:s,value:a,highlight:l}){return e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:s}),e.jsx("span",{className:`text-sm font-medium ${l?"text-blue-400":"text-white"}`,children:a})]})}function D({label:s,value:a,color:l}){return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${l}`,children:a}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:s})]})}export{we as default};
