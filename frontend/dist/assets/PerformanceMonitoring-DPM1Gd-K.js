import{r as o,j as e,R as le,a9 as W,a8 as T,aC as he,C as ce,e as oe,aZ as ue,bJ as ye,bx as pe,s as G,L as be,ab as P,T as q,ag as je,ah as fe,aY as X,D as Ne,bK as Y,bL as Q,ae as ve,ad as ke,bu as we,bM as Ce,A as Se,v as Ae}from"./index-BhHU9tw7.js";import{a as V}from"./client-DYAnEeaj.js";import"./contents.api-B-galxu-.js";import{R as J,X as Z,Y as R,B as ee,E as te}from"./generateCategoricalChart-DU228K-S.js";import{A as $e,a as F}from"./AreaChart-D1rludVe.js";import{C as se}from"./CartesianGrid-jB4oqlPs.js";import{L as Fe,a as E}from"./LineChart-Bv3h4l-D.js";import"./index-B9ygI19o.js";import"./tiny-invariant-BaFNuDhB.js";const re={getMetrics:async()=>(await V.get("/v1/system/metrics")).data,getHealth:async()=>(await V.get("/system/health")).data},Me={brain:{description:"Brain API 服务，提供决策引擎和状态管理功能",endpoint:"/api/brain"},workspace:{description:"工作区服务，管理项目配置和文件系统",endpoint:"/api/workspace"},quality:{description:"质量监控服务，负责代码审计和自动化测试",endpoint:"/api/quality"},n8n:{description:"N8N 工作流自动化引擎，处理任务调度",endpoint:"http://localhost:5679"}};function Le(r){if(!r)return"未知";const a=new Date(r),i=new Date().getTime()-a.getTime(),n=Math.floor(i/1e3);if(n<0)return"刚刚";if(n<60)return`${n}秒前`;const x=Math.floor(n/60);if(x<60)return`${x}分钟前`;const g=Math.floor(x/60);return g<24?`${g}小时前`:`${Math.floor(g/24)}天前`}function _e(r){return r?new Date(r).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"未知"}function Ie({history:r}){const a=o.useMemo(()=>{if(r.length<2)return null;const t=r.filter(m=>m.status==="healthy").length,i=r.length,n=t/i*100,x=r.filter(m=>m.latency_ms!==null).map(m=>m.latency_ms),g=x.length>0?x.reduce((m,y)=>m+y,0)/x.length:null;return{uptime:n.toFixed(1),avgLatency:g!==null?Math.round(g):null,totalChecks:i}},[r]);return a?e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200/50 dark:border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx(G,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"统计摘要"}),e.jsxs("span",{className:"text-gray-400 text-xs",children:["（",a.totalChecks," 次检查）"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"可用率"}),e.jsxs("div",{className:`text-sm font-semibold ${parseFloat(a.uptime)>=99?"text-green-600 dark:text-green-400":parseFloat(a.uptime)>=95?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"}`,children:[a.uptime,"%"]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"平均延迟"}),a.avgLatency!==null?e.jsxs("div",{className:`text-sm font-semibold ${a.avgLatency<100?"text-green-600 dark:text-green-400":a.avgLatency<500?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"}`,children:[a.avgLatency,"ms"]}):e.jsx("div",{className:"text-sm text-gray-400",children:"N/A"})]})]})]}):e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200/50 dark:border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx(G,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"统计摘要"})]}),e.jsx("div",{className:"text-xs text-gray-400 italic",children:"数据不足（需要至少 2 条记录）"})]})}function Oe({name:r,label:a,service:t,history:i,onRefresh:n}){const[x,g]=o.useState(!1),[m,y]=o.useState(!1),S=async c=>{if(c.stopPropagation(),!(!n||m)){y(!0);try{await n()}finally{y(!1)}}},p=t.status==="healthy",f=Me[r];return e.jsxs("div",{className:`rounded-lg border transition-all duration-200 cursor-pointer ${p?"border-green-200 bg-green-50 hover:bg-green-100/80 dark:border-green-800 dark:bg-green-900/20 dark:hover:bg-green-900/30":"border-red-200 bg-red-50 hover:bg-red-100/80 dark:border-red-800 dark:bg-red-900/20 dark:hover:bg-red-900/30"} ${x?"ring-2 ring-offset-1":"hover:shadow-sm"} ${p?x?"ring-green-300 dark:ring-green-700":"":x?"ring-red-300 dark:ring-red-700":""}`,children:[e.jsxs("button",{onClick:()=>g(!x),className:"w-full p-3 text-left",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:a}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[n&&e.jsx("button",{onClick:S,disabled:m,className:`p-1 rounded hover:bg-white/50 dark:hover:bg-black/20 transition-colors ${m?"opacity-50 cursor-not-allowed":""}`,title:"刷新健康状态",children:e.jsx(le,{className:`w-3.5 h-3.5 text-gray-500 ${m?"animate-spin":""}`})}),p?e.jsx(W,{className:"w-4 h-4 text-green-500"}):e.jsx(T,{className:"w-4 h-4 text-red-500"}),x?e.jsx(he,{className:"w-3.5 h-3.5 text-gray-400"}):e.jsx(ce,{className:"w-3.5 h-3.5 text-gray-400"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-0.5",children:[t.latency_ms!==null?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"延迟:"}),e.jsxs("span",{className:`font-medium ${t.latency_ms<100?"text-green-600 dark:text-green-400":t.latency_ms<500?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"}`,children:[t.latency_ms,"ms"]})]}):e.jsx("div",{className:"text-red-500",children:t.error||"不可用"}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-400 cursor-help",title:_e(t.last_check),children:[e.jsx(oe,{className:"w-3 h-3"}),e.jsx("span",{children:Le(t.last_check)})]})]})]}),x&&e.jsx("div",{className:"px-3 pb-3 pt-0 border-t border-gray-200/50 dark:border-gray-700/50",children:e.jsxs("div",{className:"mt-3 space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"服务标识:"}),e.jsx("span",{className:"font-mono text-gray-700 dark:text-gray-300",children:r})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"状态:"}),e.jsx("span",{className:`font-medium ${p?"text-green-600":"text-red-600"}`,children:p?"健康":"异常"})]}),t.latency_ms!==null&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"响应延迟:"}),e.jsxs("span",{className:`font-medium ${t.latency_ms<100?"text-green-600":t.latency_ms<500?"text-amber-600":"text-red-600"}`,children:[t.latency_ms,"ms",t.latency_ms<100&&" (优秀)",t.latency_ms>=100&&t.latency_ms<500&&" (正常)",t.latency_ms>=500&&" (较慢)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"检查时间:"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:t.last_check?new Date(t.last_check).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"未知"})]}),f&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200/50 dark:border-gray-700/50",children:[e.jsxs("div",{className:"flex items-start gap-1.5",children:[e.jsx(ue,{className:"w-3 h-3 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:f.description})]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5",children:[e.jsx(ye,{className:"w-3 h-3 text-gray-400 flex-shrink-0"}),e.jsx("code",{className:"text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded text-xs",children:f.endpoint})]})]}),t.error&&e.jsxs("div",{className:"mt-2 p-2 bg-red-100 dark:bg-red-900/30 rounded text-red-700 dark:text-red-300",children:[e.jsx("div",{className:"font-medium mb-1",children:"错误详情:"}),e.jsx("div",{className:"font-mono text-xs break-all",children:t.error})]}),i&&i.length>0&&e.jsx(Ie,{history:i}),i&&i.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200/50 dark:border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(pe,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"健康检查历史"})]}),(()=>{const b=i.filter(w=>w.status==="healthy").length/i.length*100;return e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded ${b>=99?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":b>=95?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:[b.toFixed(0),"% 可用"]})})()]}),e.jsx("div",{className:"space-y-1.5",children:i.slice(0,5).map((c,b)=>e.jsxs("div",{className:`flex items-center justify-between p-2 rounded ${c.status==="healthy"?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c.status==="healthy"?e.jsx(W,{className:"w-3 h-3 text-green-500"}):e.jsx(T,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{className:`text-xs font-medium ${c.status==="healthy"?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400"}`,children:c.status==="healthy"?"健康":"异常"}),c.latency_ms!==null&&e.jsxs("span",{className:`text-xs ${c.latency_ms<100?"text-green-600 dark:text-green-400":c.latency_ms<500?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"}`,children:[c.latency_ms,"ms"]})]}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(c.timestamp).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]},b))}),i.length>5&&e.jsxs("div",{className:"mt-1.5 text-xs text-gray-400 text-center",children:["显示最近 5 条，共 ",i.length," 条记录"]})]})]})})]})}function Re(r){const a=Math.floor(r/86400),t=Math.floor(r%86400/3600),i=Math.floor(r%3600/60);return a>0?`${a}d ${t}h`:t>0?`${t}h ${i}m`:`${i}m`}function ae(r){return`${(r/1073741824).toFixed(1)} GB`}function M(r){return r>=1024*1024*1024?`${(r/(1024*1024*1024)).toFixed(1)} GB/s`:r>=1024*1024?`${(r/(1024*1024)).toFixed(1)} MB/s`:r>=1024?`${(r/1024).toFixed(1)} KB/s`:`${r.toFixed(0)} B/s`}function L(r,a){return r>=a.danger?"text-red-500":r>=a.warn?"text-amber-500":"text-green-500"}function de(r,a){return r>=a.danger?"bg-red-500":r>=a.warn?"bg-amber-500":"bg-green-500"}function ne(){const r=Date.now();return{current:{cpuUsage:35+Math.random()*20,memoryUsage:62+Math.random()*10,memoryTotal:8*1024*1024*1024,memoryUsed:5*1024*1024*1024,avgResponseTime:120+Math.random()*80,errorRate:.1+Math.random()*.5,activeConnections:12+Math.floor(Math.random()*8),uptime:86400*3+3600*7,diskIO:{readSpeed:(50+Math.random()*100)*1024*1024,writeSpeed:(30+Math.random()*80)*1024*1024},networkIO:{downloadSpeed:(10+Math.random()*50)*1024*1024,uploadSpeed:(5+Math.random()*20)*1024*1024}},history:Array.from({length:10},(a,t)=>({timestamp:new Date(r-(9-t)*3e4).toISOString(),cpuUsage:30+Math.random()*25,memoryUsage:60+Math.random()*15,responseTime:100+Math.random()*100}))}}const B={brain:"Brain",workspace:"Workspace",quality:"Quality",n8n:"N8N"},ie=[{value:1e4,label:"10s"},{value:3e4,label:"30s"},{value:6e4,label:"60s"},{value:0,label:"暂停"}],Ee=20;function Pe(){var H,z,D,K;const[r,a]=o.useState(null),[t,i]=o.useState(null),[n,x]=o.useState({}),[g,m]=o.useState(!0),[y,S]=o.useState(""),[p,f]=o.useState(""),[c,b]=o.useState(3e4),[w,_]=o.useState(!1),N=o.useRef(null),I=o.useRef(null),A=async()=>{try{m(!0);const[s,d]=await Promise.allSettled([re.getMetrics(),re.getHealth()]);if(s.status==="fulfilled"?a(s.value):a(ne()),d.status==="fulfilled"){const h=d.value;i(h);const u=new Date().toISOString();x(v=>{const j={...v};return Object.entries(h.services).forEach(([k,C])=>{const me={timestamp:u,status:C.status,latency_ms:C.latency_ms,error:C.error},ge=[...j[k]||[],me];j[k]=ge.slice(-Ee)}),j})}S(""),f(new Date().toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}))}catch{a(ne()),S(""),f(new Date().toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}))}finally{m(!1)}};o.useEffect(()=>{A()},[]),o.useEffect(()=>(N.current&&(clearInterval(N.current),N.current=null),c>0&&(N.current=setInterval(A,c)),()=>{N.current&&clearInterval(N.current)}),[c]),o.useEffect(()=>{const s=d=>{I.current&&!I.current.contains(d.target)&&_(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const xe=()=>{const s=ie.find(d=>d.value===c);return(s==null?void 0:s.label)||"30s"},$=o.useMemo(()=>{const s={};return Object.entries(n).forEach(([d,h])=>{const u=h.length,v=h.filter(j=>j.status==="healthy").length;s[d]={uptime:v,total:u,percentage:u>0?v/u*100:100}}),s},[n]),U=o.useMemo(()=>{const s=new Set;return Object.values(n).forEach(h=>{h.forEach(u=>s.add(u.timestamp))}),Array.from(s).sort().map(h=>{const u={time:new Date(h).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"})};return Object.entries(n).forEach(([v,j])=>{const k=j.find(C=>C.timestamp===h);u[v]=(k==null?void 0:k.latency_ms)??null}),u})},[n]),O=o.useMemo(()=>{const s=Object.values($);return s.length===0?100:s.reduce((h,u)=>h+u.percentage,0)/s.length},[$]),l=(r==null?void 0:r.current)||{cpuUsage:0,memoryUsage:0,memoryTotal:0,memoryUsed:0,avgResponseTime:0,errorRate:0,activeConnections:0,uptime:0};return g&&!r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(be,{className:"w-6 h-6 animate-spin text-gray-400"})}):y&&!r?e.jsxs("div",{className:"flex items-center justify-center h-64 text-red-500",children:[e.jsx(T,{className:"w-5 h-5 mr-2"}),y]}):e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"性能监控"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"系统资源和性能指标概览"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",ref:I,children:[e.jsxs("button",{onClick:()=>_(!w),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:[c===0?e.jsx(P,{className:"w-3 h-3"}):e.jsx(q,{className:"w-3 h-3"}),e.jsx("span",{children:xe()}),e.jsx(ce,{className:`w-3 h-3 transition-transform ${w?"rotate-180":""}`})]}),w&&e.jsx("div",{className:"absolute right-0 mt-1 w-32 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-10",children:ie.map(s=>e.jsxs("button",{onClick:()=>{b(s.value),_(!1)},className:`w-full px-3 py-2 text-left text-xs flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors ${c===s.value?"text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20":"text-gray-700 dark:text-gray-300"}`,children:[s.value===0?e.jsx(P,{className:"w-3 h-3"}):e.jsx(q,{className:"w-3 h-3"}),e.jsx("span",{children:s.label})]},s.value))})]}),e.jsxs("span",{className:"text-xs text-gray-400",children:[p," 更新"]}),e.jsx("button",{onClick:A,disabled:g,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:e.jsx(le,{className:`w-4 h-4 ${g?"animate-spin":""}`})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-2",children:[e.jsx(je,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"CPU 使用率"})]}),e.jsxs("div",{className:`text-2xl font-bold ${L(l.cpuUsage,{warn:70,danger:90})}`,children:[l.cpuUsage.toFixed(1),"%"]}),e.jsx("div",{className:"mt-2 h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${de(l.cpuUsage,{warn:70,danger:90})}`,style:{width:`${Math.min(l.cpuUsage,100)}%`}})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-2",children:[e.jsx(fe,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"内存使用"})]}),e.jsxs("div",{className:`text-2xl font-bold ${L(l.memoryUsage,{warn:75,danger:90})}`,children:[l.memoryUsage.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[ae(l.memoryUsed)," / ",ae(l.memoryTotal)]}),e.jsx("div",{className:"mt-2 h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${de(l.memoryUsage,{warn:75,danger:90})}`,style:{width:`${Math.min(l.memoryUsage,100)}%`}})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-2",children:[e.jsx(oe,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"平均响应时间"})]}),e.jsxs("div",{className:`text-2xl font-bold ${L(l.avgResponseTime,{warn:500,danger:1e3})}`,children:[l.avgResponseTime.toFixed(0),"ms"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-2",children:[e.jsx(X,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"错误率"})]}),e.jsxs("div",{className:`text-2xl font-bold ${L(l.errorRate,{warn:1,danger:5})}`,children:[l.errorRate.toFixed(2),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-3",children:[e.jsx(Ne,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"磁盘 I/O"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-400 mb-1",children:[e.jsx(Y,{className:"w-3 h-3 text-blue-500"}),e.jsx("span",{children:"读取"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:M(((H=l.diskIO)==null?void 0:H.readSpeed)||0)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-400 mb-1",children:[e.jsx(Q,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"写入"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:M(((z=l.diskIO)==null?void 0:z.writeSpeed)||0)})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-3",children:[e.jsx(ve,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"网络吞吐"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-400 mb-1",children:[e.jsx(Y,{className:"w-3 h-3 text-blue-500"}),e.jsx("span",{children:"下载"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:M(((D=l.networkIO)==null?void 0:D.downloadSpeed)||0)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-400 mb-1",children:[e.jsx(Q,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"上传"})]}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:M(((K=l.networkIO)==null?void 0:K.uploadSpeed)||0)})]})]})]})]}),t&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden mb-4",children:[e.jsx("div",{className:"px-5 py-4 border-b border-gray-50 dark:border-gray-700/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-purple-50 dark:bg-purple-900/20",children:e.jsx(ke,{className:"w-5 h-5 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"服务健康状态"}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"多服务聚合健康检查"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${t.status==="healthy"?"bg-green-500":t.status==="degraded"?"bg-amber-500":"bg-red-500"} animate-pulse`}),e.jsx("span",{className:`text-sm font-medium ${t.status==="healthy"?"text-green-500":t.status==="degraded"?"text-amber-500":"text-red-500"}`,children:t.status==="healthy"?"健康":t.status==="degraded"?"降级":"异常"})]})]})}),e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("div",{className:"grid grid-cols-4 gap-4",children:Object.entries(t.services).map(([s,d])=>e.jsx(Oe,{name:s,label:B[s]||s,service:d,history:n[s],onRefresh:A},s))}),t.degraded&&t.degraded_reason&&e.jsx("div",{className:"mt-4 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-amber-700 dark:text-amber-400",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm font-medium",children:["降级原因: ",t.degraded_reason]})]})})]})]}),Object.keys($).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden mb-4",children:[e.jsx("div",{className:"px-5 py-4 border-b border-gray-50 dark:border-gray-700/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-indigo-50 dark:bg-indigo-900/20",children:e.jsx(we,{className:"w-5 h-5 text-indigo-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"服务可用性 (SLA)"}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"基于健康检查历史的可用性统计"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`text-lg font-bold ${O>=99?"text-green-500":O>=95?"text-amber-500":"text-red-500"}`,children:[O.toFixed(1),"%"]}),e.jsx("span",{className:"text-xs text-gray-400",children:"整体可用率"})]})]})}),e.jsx("div",{className:"px-5 py-4",children:e.jsx("div",{className:"grid grid-cols-4 gap-4",children:Object.entries($).map(([s,d])=>e.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:B[s]||s}),e.jsxs("span",{className:`text-sm font-bold ${d.percentage>=99?"text-green-500":d.percentage>=95?"text-amber-500":"text-red-500"}`,children:[d.percentage.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-1.5 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${d.percentage>=99?"bg-green-500":d.percentage>=95?"bg-amber-500":"bg-red-500"}`,style:{width:`${d.percentage}%`}})}),e.jsxs("div",{className:"mt-1.5 text-xs text-gray-400",children:[d.uptime,"/",d.total," 次检查正常"]})]},s))})})]}),U.length>1&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden mb-4",children:[e.jsx("div",{className:"px-5 py-4 border-b border-gray-50 dark:border-gray-700/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-rose-50 dark:bg-rose-900/20",children:e.jsx(Ce,{className:"w-5 h-5 text-rose-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"健康检查延迟趋势"}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"各服务响应延迟历史变化"})]})]})}),e.jsx("div",{className:"px-5 py-4",children:e.jsx("div",{className:"h-64",children:e.jsx(J,{width:"100%",height:"100%",children:e.jsxs($e,{data:U,margin:{top:5,right:30,left:0,bottom:5},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gradientBrain",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8B5CF6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#8B5CF6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"gradientWorkspace",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"gradientQuality",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"gradientN8n",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#F59E0B",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#F59E0B",stopOpacity:0})]})]}),e.jsx(se,{strokeDasharray:"3 3",className:"stroke-gray-200 dark:stroke-gray-700"}),e.jsx(Z,{dataKey:"time",tick:{fill:"#9CA3AF",fontSize:11},tickLine:{stroke:"#9CA3AF"}}),e.jsx(R,{domain:[0,"auto"],tick:{fill:"#9CA3AF",fontSize:11},tickLine:{stroke:"#9CA3AF"},tickFormatter:s=>`${s}ms`}),e.jsx(ee,{contentStyle:{backgroundColor:"rgba(31, 41, 55, 0.95)",border:"none",borderRadius:"8px",color:"#fff",fontSize:"12px"},labelStyle:{color:"#9CA3AF"},formatter:s=>s!==null?[`${s}ms`,""]:["N/A",""]}),e.jsx(te,{wrapperStyle:{fontSize:"12px"},formatter:s=>B[s]||s}),Object.keys(n).includes("brain")&&e.jsx(F,{type:"monotone",dataKey:"brain",stroke:"#8B5CF6",fill:"url(#gradientBrain)",strokeWidth:2,dot:{r:2},connectNulls:!0}),Object.keys(n).includes("workspace")&&e.jsx(F,{type:"monotone",dataKey:"workspace",stroke:"#3B82F6",fill:"url(#gradientWorkspace)",strokeWidth:2,dot:{r:2},connectNulls:!0}),Object.keys(n).includes("quality")&&e.jsx(F,{type:"monotone",dataKey:"quality",stroke:"#10B981",fill:"url(#gradientQuality)",strokeWidth:2,dot:{r:2},connectNulls:!0}),Object.keys(n).includes("n8n")&&e.jsx(F,{type:"monotone",dataKey:"n8n",stroke:"#F59E0B",fill:"url(#gradientN8n)",strokeWidth:2,dot:{r:2},connectNulls:!0})]})})})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-5 py-4 border-b border-gray-50 dark:border-gray-700/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-blue-50 dark:bg-blue-900/20",children:e.jsx(Se,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"系统状态"}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"实时运行状态"})]})]})}),e.jsx("div",{className:"px-5 py-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"活跃连接"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:l.activeConnections})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"运行时间"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:Re(l.uptime)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"状态"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${(t==null?void 0:t.status)==="healthy"?"bg-green-500":(t==null?void 0:t.status)==="degraded"?"bg-amber-500":(t==null?void 0:t.status)==="unhealthy"?"bg-red-500":"bg-green-500"} animate-pulse`}),e.jsx("span",{className:`text-lg font-semibold ${(t==null?void 0:t.status)==="healthy"?"text-green-500":(t==null?void 0:t.status)==="degraded"?"text-amber-500":(t==null?void 0:t.status)==="unhealthy"?"text-red-500":"text-green-500"}`,children:(t==null?void 0:t.status)==="healthy"?"正常":(t==null?void 0:t.status)==="degraded"?"降级":(t==null?void 0:t.status)==="unhealthy"?"异常":"正常"})]})]})]})})]}),(r==null?void 0:r.history)&&r.history.length>0&&e.jsxs("div",{className:"mt-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-5 py-4 border-b border-gray-50 dark:border-gray-700/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-emerald-50 dark:bg-emerald-900/20",children:e.jsx(Ae,{className:"w-5 h-5 text-emerald-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"历史趋势"}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"最近 5 分钟的性能变化"})]})]})}),e.jsx("div",{className:"px-5 py-4",children:e.jsx("div",{className:"h-64",children:e.jsx(J,{width:"100%",height:"100%",children:e.jsxs(Fe,{data:r.history.slice(-10).map(s=>({time:new Date(s.timestamp).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),cpu:Math.round(s.cpuUsage),memory:Math.round(s.memoryUsage),response:Math.round(s.responseTime)})),margin:{top:5,right:30,left:0,bottom:5},children:[e.jsx(se,{strokeDasharray:"3 3",className:"stroke-gray-200 dark:stroke-gray-700"}),e.jsx(Z,{dataKey:"time",tick:{fill:"#9CA3AF",fontSize:11},tickLine:{stroke:"#9CA3AF"}}),e.jsx(R,{yAxisId:"percent",domain:[0,100],tick:{fill:"#9CA3AF",fontSize:11},tickLine:{stroke:"#9CA3AF"},tickFormatter:s=>`${s}%`}),e.jsx(R,{yAxisId:"ms",orientation:"right",domain:[0,"auto"],tick:{fill:"#9CA3AF",fontSize:11},tickLine:{stroke:"#9CA3AF"},tickFormatter:s=>`${s}ms`}),e.jsx(ee,{contentStyle:{backgroundColor:"rgba(31, 41, 55, 0.95)",border:"none",borderRadius:"8px",color:"#fff",fontSize:"12px"},labelStyle:{color:"#9CA3AF"}}),e.jsx(te,{wrapperStyle:{fontSize:"12px"},formatter:s=>({cpu:"CPU 使用率",memory:"内存使用率",response:"响应时间"})[s]||s}),e.jsx(E,{yAxisId:"percent",type:"monotone",dataKey:"cpu",stroke:"#3B82F6",strokeWidth:2,dot:{r:3},activeDot:{r:5}}),e.jsx(E,{yAxisId:"percent",type:"monotone",dataKey:"memory",stroke:"#10B981",strokeWidth:2,dot:{r:3},activeDot:{r:5}}),e.jsx(E,{yAxisId:"ms",type:"monotone",dataKey:"response",stroke:"#F59E0B",strokeWidth:2,dot:{r:3},activeDot:{r:5}})]})})})})]})]})}export{Pe as default};
