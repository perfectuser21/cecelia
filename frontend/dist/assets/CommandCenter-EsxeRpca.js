import{am as Q,an as W,r as b,j as e,ap as X,aq as w,ad as Y,ag as E,ac as P,n as L,C as $,$ as y,aE as O,aF as S,A as Z,v as ee,a9 as D,aG as q,ao as G,aH as te,e as M}from"./index-BhHU9tw7.js";function C({items:a}){return e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400 mb-6",children:[e.jsxs(G,{to:"/command",className:"hover:text-blue-500 flex items-center gap-1",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{children:"Command Center"})]}),a.map((i,h)=>e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),i.path?e.jsx(G,{to:i.path,className:"hover:text-blue-500",children:i.label}):e.jsx("span",{className:"text-slate-700 dark:text-slate-200",children:i.label})]},h))]})}function R({icon:a,title:i,subtitle:h,onClick:r,color:N="blue",children:d}){const m={blue:"bg-blue-100 dark:bg-blue-900/30 text-blue-500",purple:"bg-purple-100 dark:bg-purple-900/30 text-purple-500",emerald:"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-500",cyan:"bg-cyan-100 dark:bg-cyan-900/30 text-cyan-500",amber:"bg-amber-100 dark:bg-amber-900/30 text-amber-500"};return e.jsxs("button",{onClick:r,disabled:!r,className:`p-6 rounded-2xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 text-left w-full transition-all ${r?"hover:border-blue-300 hover:shadow-lg cursor-pointer":"cursor-default"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${m[N]}`,children:e.jsx(a,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"font-semibold text-slate-800 dark:text-white",children:i}),e.jsx("p",{className:"text-xs text-slate-500",children:h})]}),r&&e.jsx(y,{className:"w-5 h-5 text-slate-400"})]}),d]})}function A({brainStatus:a,tickStatus:i,goals:h,tasks:r,projects:N,vpsSlots:d,runningTasks:m,navigate:x}){var c;const[j,p]=b.useState(new Set),n=t=>{p(s=>{const l=new Set(s);return l.has(t)?l.delete(t):l.add(t),l})},o=t=>r.filter(s=>s.goal_id===t),g=t=>{switch(t){case"completed":return e.jsx(D,{className:"w-4 h-4 text-emerald-500"});case"in_progress":return e.jsx(P,{className:"w-4 h-4 text-blue-500 animate-pulse"});case"queued":return e.jsx(M,{className:"w-4 h-4 text-amber-500"});default:return e.jsx(q,{className:"w-4 h-4 text-slate-400"})}},f=t=>{const s=o(t),l=s.length,u=s.filter(T=>T.status==="completed").length;return{total:l,completed:u,percent:l>0?Math.round(u/l*100):0}},v=(()=>{const t=new Date().toDateString(),s=r.filter(u=>u.status!=="completed"||!u.completed_at?!1:new Date(u.completed_at).toDateString()===t).length,l=r.filter(u=>u.started_at?new Date(u.started_at).toDateString()===t:!1).length;return{todayCompleted:s,todayStarted:l}})();return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:"Command Center"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2",children:"统一控制中心"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(R,{icon:Y,title:"VPS 状态",subtitle:"Claude 并发槽位",color:"cyan",onClick:()=>x("/command/vps"),children:[e.jsx("div",{className:"flex gap-2 mb-3",children:Array.from({length:d.total}).map((t,s)=>{var u;const l=(u=d.slots)==null?void 0:u[s];return e.jsx("div",{className:`flex-1 h-8 rounded-lg flex items-center justify-center text-xs font-medium transition-all ${l?"bg-blue-500 text-white animate-pulse":"bg-slate-100 dark:bg-slate-700 text-slate-400"}`,title:l?`PID: ${l.pid}
CPU: ${l.cpu}
Mem: ${l.memory}`:"空闲",children:l?e.jsx(E,{className:"w-4 h-4"}):""},s)})}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"font-bold text-blue-500",children:d.used})," / ",d.total," 槽位使用中",((c=d.slots)==null?void 0:c.length)>0&&e.jsx("span",{className:"ml-2 text-xs text-slate-400",children:"(真实进程)"})]})]}),e.jsxs(R,{icon:P,title:"今日执行",subtitle:`Tick: ${i!=null&&i.enabled?"已启用":"已禁用"}`,color:"blue",onClick:()=>x("/command/execution"),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800",children:[e.jsx("p",{className:"text-2xl font-bold text-emerald-600 dark:text-emerald-400",children:v.todayCompleted}),e.jsx("p",{className:"text-xs text-slate-500",children:"今日完成"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:v.todayStarted}),e.jsx("p",{className:"text-xs text-slate-500",children:"今日启动"})]})]}),m.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"执行中:"}),m.slice(0,2).map(t=>e.jsx("div",{className:"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-3 h-3 text-blue-500 animate-pulse"}),e.jsxs("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-200 truncate",children:[t.title.slice(0,35),"..."]})]})},t.id))]}):e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs",children:"暂无执行中的任务"})]})]}),e.jsxs(R,{icon:L,title:"OKR 目标",subtitle:"点击展开查看详情",color:"purple",onClick:()=>x("/command/okr"),children:[(a==null?void 0:a.daily_focus)&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),n(a.daily_focus.objective_id)},className:"w-full text-left p-4 rounded-xl bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 hover:border-purple-400 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[j.has(a.daily_focus.objective_id)?e.jsx($,{className:"w-5 h-5 text-purple-500"}):e.jsx(y,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"font-medium text-slate-800 dark:text-white",children:a.daily_focus.objective_title})]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-purple-200 dark:bg-purple-800 text-purple-700 dark:text-purple-200 rounded-full",children:"P0 Focus"})]})}),j.has(a.daily_focus.objective_id)&&e.jsx("div",{className:"ml-6 space-y-2",children:a.daily_focus.key_results.map(t=>{const s=f(t.id);return e.jsxs("div",{children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),n(t.id)},className:"w-full text-left p-3 rounded-lg bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[j.has(t.id)?e.jsx($,{className:"w-4 h-4 text-slate-400"}):e.jsx(y,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:t.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:[s.completed,"/",s.total," tasks"]}),e.jsx("div",{className:"w-16 h-2 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 transition-all",style:{width:`${s.percent}%`}})})]})]})}),j.has(t.id)&&e.jsx("div",{className:"ml-6 mt-2 space-y-1",children:o(t.id).map(l=>e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700/30 cursor-pointer",onClick:u=>{u.stopPropagation(),x(`/command/tasks/${l.id}`)},children:[g(l.status),e.jsxs("span",{className:`text-sm flex-1 ${l.status==="completed"?"text-slate-400 line-through":"text-slate-600 dark:text-slate-300"}`,children:[l.title.slice(0,50),"..."]}),e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${l.priority==="P1"?"bg-red-100 text-red-600":"bg-slate-100 text-slate-500"}`,children:l.priority})]},l.id))})]},t.id)})})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-200 dark:border-slate-700 flex gap-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:r.filter(t=>t.status==="queued").length}),e.jsx("span",{className:"text-sm text-slate-500 ml-2",children:"待执行"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold text-blue-500",children:r.filter(t=>t.status==="in_progress").length}),e.jsx("span",{className:"text-sm text-slate-500 ml-2",children:"执行中"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold text-emerald-500",children:r.filter(t=>t.status==="completed").length}),e.jsx("span",{className:"text-sm text-slate-500 ml-2",children:"已完成"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:()=>x("/command/tasks"),className:"p-4 rounded-xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 hover:border-blue-300 hover:shadow-lg transition-all text-left",children:[e.jsx(O,{className:"w-6 h-6 text-blue-500 mb-2"}),e.jsx("h3",{className:"font-medium text-slate-800 dark:text-white",children:"Tasks"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[r.length," 个任务"]})]}),e.jsxs("button",{onClick:()=>x("/command/projects"),className:"p-4 rounded-xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 hover:border-emerald-300 hover:shadow-lg transition-all text-left",children:[e.jsx(S,{className:"w-6 h-6 text-emerald-500 mb-2"}),e.jsx("h3",{className:"font-medium text-slate-800 dark:text-white",children:"Projects"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[N.length," 个项目"]})]}),e.jsxs("button",{onClick:()=>x("/command/execution"),className:"p-4 rounded-xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 hover:border-purple-300 hover:shadow-lg transition-all text-left",children:[e.jsx(Z,{className:"w-6 h-6 text-purple-500 mb-2"}),e.jsx("h3",{className:"font-medium text-slate-800 dark:text-white",children:"Execution"}),e.jsx("p",{className:"text-xs text-slate-500",children:"执行历史"})]}),e.jsxs("button",{disabled:!0,className:"p-4 rounded-xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 opacity-50 cursor-not-allowed text-left",children:[e.jsx(ee,{className:"w-6 h-6 text-amber-500 mb-2"}),e.jsx("h3",{className:"font-medium text-slate-800 dark:text-white",children:"Analytics"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Coming soon"})]})]})]})}function se({goals:a,tasks:i,navigate:h}){const[r,N]=b.useState(new Set),d=a.filter(n=>!n.parent_id),m=a.filter(n=>n.parent_id),x=n=>{N(o=>{const g=new Set(o);return g.has(n)?g.delete(n):g.add(n),g})},j=n=>m.filter(o=>o.parent_id===n),p=n=>i.filter(o=>o.goal_id===n);return e.jsxs("div",{children:[e.jsx(C,{items:[{label:"OKR 目标"}]}),e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-6",children:"OKR 目标"}),e.jsx("div",{className:"space-y-4",children:d.map(n=>{const o=j(n.id),g=o.reduce((c,t)=>c+p(t.id).length,0),f=o.reduce((c,t)=>c+p(t.id).filter(s=>s.status==="completed").length,0),k=o.map(c=>{const t=p(c.id);return t.length>0?t.filter(s=>s.status==="completed").length/t.length*100:0}),v=k.length>0?Math.round(k.reduce((c,t)=>c+t,0)/k.length):0;return e.jsxs("div",{className:"bg-white dark:bg-slate-800/80 rounded-2xl border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("button",{onClick:()=>x(n.id),className:"w-full p-6 text-left hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[r.has(n.id)?e.jsx($,{className:"w-5 h-5 text-purple-500"}):e.jsx(y,{className:"w-5 h-5 text-purple-500"}),e.jsx(L,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"font-semibold text-slate-800 dark:text-white",children:n.title})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-slate-500",children:[f,"/",g," tasks"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${n.priority==="P0"?"bg-red-100 text-red-600":"bg-slate-100 text-slate-500"}`,children:n.priority||"P1"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-3 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 transition-all",style:{width:`${v}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-purple-600 dark:text-purple-400 w-12 text-right",children:[v,"%"]})]})]}),r.has(n.id)&&e.jsx("div",{className:"px-6 pb-6 space-y-3",children:o.map(c=>{const t=p(c.id);return e.jsxs("div",{className:"ml-8",children:[e.jsx("button",{onClick:()=>x(c.id),className:"w-full p-4 rounded-xl bg-slate-50 dark:bg-slate-700/50 text-left hover:bg-slate-100 dark:hover:bg-slate-700 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r.has(c.id)?e.jsx($,{className:"w-4 h-4"}):e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-200",children:c.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:[t.filter(s=>s.status==="completed").length,"/",t.length]}),e.jsx("div",{className:"w-20 h-2 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${t.length?t.filter(s=>s.status==="completed").length/t.length*100:0}%`}})})]})]})}),r.has(c.id)&&e.jsx("div",{className:"ml-6 mt-2 space-y-1",children:t.map(s=>e.jsxs("div",{onClick:()=>h(`/command/tasks/${s.id}`),className:"flex items-center gap-2 p-3 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-600/50 cursor-pointer",children:[s.status==="completed"?e.jsx(D,{className:"w-4 h-4 text-emerald-500"}):s.status==="in_progress"?e.jsx(P,{className:"w-4 h-4 text-blue-500 animate-pulse"}):e.jsx(q,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:`flex-1 text-sm ${s.status==="completed"?"line-through text-slate-400":"text-slate-600 dark:text-slate-300"}`,children:s.title}),e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${s.priority==="P1"?"bg-red-100 text-red-600":"bg-slate-100 text-slate-500"}`,children:s.priority})]},s.id))})]},c.id)})})]},n.id)})})]})}function ae({projects:a,tasks:i,navigate:h}){const r=a.filter(d=>!d.parent_id),N=d=>{const m=i.filter(n=>n.project_id===d),x=m.length,j=m.filter(n=>n.status==="completed").length,p=x>0?Math.round(j/x*100):0;return{total:x,completed:j,completionRate:p}};return e.jsxs("div",{children:[e.jsx(C,{items:[{label:"Projects"}]}),e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-6",children:"Projects"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.map(d=>{const m=N(d.id);return e.jsxs("button",{onClick:()=>h(`/command/projects/${d.id}`),className:"p-6 rounded-2xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 text-left hover:border-emerald-300 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center",children:e.jsx(S,{className:"w-5 h-5 text-emerald-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white",children:d.name}),d.repo_path&&e.jsx("p",{className:"text-xs text-slate-500 truncate",children:d.repo_path})]})]}),d.description&&e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 line-clamp-2 mb-3",children:d.description}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-slate-400"}),e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-300",children:[m.completed,"/",m.total," tasks"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 h-2 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 transition-all",style:{width:`${m.completionRate}%`}})}),e.jsxs("span",{className:"text-xs text-slate-500",children:[m.completionRate,"%"]})]})]})]},d.id)}),r.length===0&&e.jsx("div",{className:"col-span-full text-center py-12 text-slate-500",children:"暂无项目"})]})]})}function le({tasks:a,projects:i,navigate:h}){const[r,N]=b.useState("all"),[d,m]=b.useState("all"),[x,j]=b.useState("all"),[p,n]=b.useState(!0),o=a.filter(t=>{if(r!=="all"&&t.status!==r)return!1;if(d==="unassigned"){if(t.project_id)return!1}else if(d!=="all"&&t.project_id!==d)return!1;return!(x!=="all"&&t.priority!==x)}),g=o.reduce((t,s)=>{const l=s.project_id||"unassigned";return t[l]||(t[l]=[]),t[l].push(s),t},{}),f=t=>{if(t==="unassigned")return"未分配";const s=i.find(l=>l.id===t);return(s==null?void 0:s.name)||t.slice(0,8)},k={all:a.length,queued:a.filter(t=>t.status==="queued").length,in_progress:a.filter(t=>t.status==="in_progress").length,completed:a.filter(t=>t.status==="completed").length},v=t=>{switch(t){case"completed":return e.jsx(D,{className:"w-4 h-4 text-emerald-500"});case"in_progress":return e.jsx(P,{className:"w-4 h-4 text-blue-500 animate-pulse"});default:return e.jsx(M,{className:"w-4 h-4 text-amber-500"})}},c=({task:t})=>e.jsx("button",{onClick:()=>h(`/command/tasks/${t.id}`),className:"w-full p-3 rounded-lg bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 text-left hover:border-blue-300 transition-all",children:e.jsxs("div",{className:"flex items-center gap-3",children:[v(t.status),e.jsx("span",{className:`flex-1 text-sm ${t.status==="completed"?"line-through text-slate-400":"text-slate-700 dark:text-slate-200"}`,children:t.title}),e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${t.priority==="P0"?"bg-red-200 text-red-700":t.priority==="P1"?"bg-orange-100 text-orange-600":"bg-slate-100 text-slate-500"}`,children:t.priority})]})});return e.jsxs("div",{children:[e.jsx(C,{items:[{label:"Tasks"}]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Tasks"}),e.jsx("button",{onClick:()=>n(!p),className:`px-3 py-1.5 rounded-lg text-sm transition-all ${p?"bg-emerald-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-600"}`,children:p?"Grouped":"Flat"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 p-4 rounded-xl bg-white dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Status:"}),e.jsx("div",{className:"flex gap-1",children:["all","queued","in_progress","completed"].map(t=>e.jsxs("button",{onClick:()=>N(t),className:`px-2 py-1 rounded text-xs transition-all ${r===t?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200"}`,children:[t==="all"?"All":t==="in_progress"?"Running":t.charAt(0).toUpperCase()+t.slice(1),t!=="all"&&e.jsxs("span",{className:"ml-1",children:["(",k[t],")"]})]},t))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Project:"}),e.jsxs("select",{value:d,onChange:t=>m(t.target.value),className:"px-2 py-1 rounded text-xs bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 border-0",children:[e.jsx("option",{value:"all",children:"All Projects"}),i.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id)),e.jsx("option",{value:"unassigned",children:"Unassigned"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Priority:"}),e.jsx("div",{className:"flex gap-1",children:["all","P0","P1","P2"].map(t=>e.jsx("button",{onClick:()=>j(t),className:`px-2 py-1 rounded text-xs transition-all ${x===t?t==="P0"?"bg-red-500 text-white":t==="P1"?"bg-orange-500 text-white":t==="P2"?"bg-slate-500 text-white":"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200"}`,children:t==="all"?"All":t},t))})]})]}),p?e.jsx("div",{className:"space-y-6",children:Object.entries(g).map(([t,s])=>e.jsxs("div",{className:"bg-white dark:bg-slate-800/80 rounded-2xl border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"w-5 h-5 text-emerald-500"}),e.jsx("span",{className:"font-semibold text-slate-800 dark:text-white",children:f(t)}),e.jsxs("span",{className:"text-xs text-slate-500",children:["(",s.length," tasks)"]})]})}),e.jsx("div",{className:"p-3 space-y-2",children:s.map(l=>e.jsx(c,{task:l},l.id))})]},t))}):e.jsx("div",{className:"space-y-2",children:o.map(t=>e.jsx(c,{task:t},t.id))}),o.length===0&&e.jsx("div",{className:"text-center py-12 text-slate-500",children:"暂无任务"})]})}function re({vpsSlots:a}){var i;return e.jsxs("div",{children:[e.jsx(C,{items:[{label:"VPS 详情"}]}),e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-6",children:"VPS 状态详情"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"p-6 rounded-2xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"总槽位"}),e.jsx("p",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:a.total})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"使用中"}),e.jsx("p",{className:"text-3xl font-bold text-blue-500",children:a.used})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"空闲"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-500",children:a.total-a.used})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-white dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"使用率"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-500",children:[Math.round(a.used/a.total*100),"%"]})]})]}),e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-white mb-4",children:"运行中的进程"}),e.jsxs("div",{className:"space-y-3",children:[(i=a.slots)==null?void 0:i.map((h,r)=>e.jsx("div",{className:"p-4 rounded-xl bg-white dark:bg-slate-800/80 border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:e.jsx(E,{className:"w-6 h-6 text-blue-500"})}),e.jsxs("div",{className:"flex-1 grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"PID"}),e.jsx("p",{className:"font-mono text-slate-800 dark:text-white",children:h.pid})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"CPU"}),e.jsx("p",{className:"text-slate-800 dark:text-white",children:h.cpu})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Memory"}),e.jsx("p",{className:"text-slate-800 dark:text-white",children:h.memory})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"启动时间"}),e.jsx("p",{className:"text-slate-800 dark:text-white",children:h.startTime})]})]})]})},r)),(!a.slots||a.slots.length===0)&&e.jsx("div",{className:"text-center py-12 text-slate-500",children:"暂无运行中的 Claude 进程"})]})]})}function ne(){const a=Q();W();const[i,h]=b.useState([]),[r,N]=b.useState([]),[d,m]=b.useState([]),[x,j]=b.useState(null),[p,n]=b.useState(null),[o,g]=b.useState([]),[f,k]=b.useState({used:0,total:8}),[v,c]=b.useState(!0),t=b.useCallback(async()=>{try{const[s,l,u,T,B,K]=await Promise.all([fetch("/api/brain/status"),fetch("/api/brain/tick/status"),fetch("/api/tasks/goals"),fetch("/api/tasks/tasks"),fetch("/api/tasks/projects"),fetch("/api/brain/vps-slots")]),[U,V,H,F,I,_]=await Promise.all([s.json(),l.json(),u.json(),T.json(),B.json(),K.json()]);j(U),n(V),h(H||[]),N(F||[]),m(I||[]);const z=(F||[]).filter(J=>J.status==="in_progress");g(z),_.success&&k({used:_.used,total:_.total,slots:_.slots})}catch(s){console.error("Failed to fetch data:",s)}finally{c(!1)}},[]);return b.useEffect(()=>{t();const s=setInterval(t,1e4);return()=>clearInterval(s)},[t]),v?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"})}):e.jsx("div",{className:"min-h-screen -m-8 -mt-8 p-8 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs(X,{children:[e.jsx(w,{path:"/",element:e.jsx(A,{brainStatus:x,tickStatus:p,goals:i,tasks:r,projects:d,vpsSlots:f,runningTasks:o,navigate:a})}),e.jsx(w,{path:"/okr",element:e.jsx(se,{goals:i,tasks:r,navigate:a})}),e.jsx(w,{path:"/projects",element:e.jsx(ae,{projects:d,tasks:r,navigate:a})}),e.jsx(w,{path:"/tasks",element:e.jsx(le,{tasks:r,projects:d,navigate:a})}),e.jsx(w,{path:"/vps",element:e.jsx(re,{vpsSlots:f})}),e.jsx(w,{path:"/execution",element:e.jsxs("div",{children:[e.jsx(C,{items:[{label:"Execution History"}]}),e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-6",children:"执行历史"}),e.jsx("p",{className:"text-slate-500",children:"Coming soon..."})]})}),e.jsx(w,{path:"/*",element:e.jsx(A,{brainStatus:x,tickStatus:p,goals:i,tasks:r,projects:d,vpsSlots:f,runningTasks:o,navigate:a})})]})})})}export{ne as default};
