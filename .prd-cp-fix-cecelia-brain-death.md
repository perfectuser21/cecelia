---
id: prd-fix-cecelia-brain-death
version: 1.0.0
created: 2026-02-26
updated: 2026-02-26
changelog:
  - 1.0.0: 初始版本
---

# PRD: 修复 Cecelia 脑死亡 — 3 个关键 Bug

## 背景

Cecelia 的 Tick 循环在跑，但不产生有效工作。根因：45 个空 Initiative 堵死
capacity gate → decomp-checker 被阻断 → planner 找不到任务 → 系统"死亡"。

数据清理已完成（阶段 1），本 PR 修复导致空 Initiative 的 3 个代码 Bug。

## Bug 1: getSkillForTaskType 类型不匹配

**文件**: `packages/brain/src/executor.js`

decomp-checker 创建任务时 payload 写入 `decomposition: 'true'`（字符串），
但 executor 检查 `payload.decomposition === true`（布尔值），永远不匹配。
结果：所有拆解任务被错误路由到 `/dev` 而不是 `/okr`。

**修复**: 改为同时接受字符串和布尔值，并返回 `/okr`。

## Bug 2: preparePrompt 缺少 Initiative 级别处理

**文件**: `packages/brain/src/executor.js`

decomp-checker Check 6 创建的"给空 Initiative 补 Task"任务，payload 包含
`initiative_id` 但 `decomposition` 不是 `'continue'`。`preparePrompt()` 没有
`!isContinue && initiativeId` 的判断分支，走到全量 KR 拆解路径。

**修复**: 增加 Initiative 级别补充拆解分支。

## Bug 3: OKR 验证配置路径 Docker 不可达

**文件**: `docker-compose.yml`

`validate-okr-structure.js` 加载 `packages/config/okr-validation-spec.yml`，
但 Brain 容器没有挂载该目录，Docker 内读取失败。

**修复**: docker-compose.yml 增加 config 目录 volume mount。

## 成功标准

- 秋米拆解任务正确路由到 /okr
- Initiative 级别补充任务生成正确的 Task 级 prompt
- OKR 验证在 Docker 容器内能正常加载 spec 文件
