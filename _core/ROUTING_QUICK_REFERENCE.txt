================================================================================
CECELIA CORE ä»»åŠ¡è·¯ç”±ç³»ç»Ÿ - å¿«é€Ÿå‚è€ƒå¡
================================================================================

ã€æ ¸å¿ƒæ–‡ä»¶ä½ç½®ã€‘

1. ä»»åŠ¡è·¯ç”± (Task Router)
   ğŸ“ /home/xx/perfect21/cecelia/core/brain/src/task-router.js (212 è¡Œ)
   ğŸ”§ LOCATION_MAP, SINGLE_TASK_PATTERNS, FEATURE_PATTERNS
   â†’ identifyWorkType(), getTaskLocation(), routeTaskCreate()

2. è§„åˆ’å™¨ (Planner)
   ğŸ“ /home/xx/perfect21/cecelia/core/brain/src/planner.js (545 è¡Œ)
   ğŸ”§ scoreKRs(), selectTargetKR(), planNextTask()
   â†’ KR è¯„åˆ† + ä»»åŠ¡é€‰æ‹©ç®—æ³•

3. æ‰§è¡Œå™¨ (Executor)
   ğŸ“ /home/xx/perfect21/cecelia/core/brain/src/executor.js (1661 è¡Œ)
   ğŸ”§ èµ„æºç®¡ç†ã€æ´¾å‘æ‰§è¡Œ
   â†’ åŠ¨æ€åº§ä½åˆ†é…ã€CPU/å†…å­˜é˜ˆå€¼

4. ä¸˜è„‘ (Thalamus)
   ğŸ“ /home/xx/perfect21/cecelia/core/brain/src/thalamus.js (~600+ è¡Œ)
   ğŸ”§ ACTION_WHITELIST (30+), å†³ç­–éªŒè¯
   â†’ LLM å†³ç­–çš„"æŒ‡ä»¤ç™½åå•"

5. æ„å›¾è¯†åˆ« (Intent)
   ğŸ“ /home/xx/perfect21/cecelia/core/brain/src/intent.js (~700+ è¡Œ)
   ğŸ”§ 9 ç§æ„å›¾ç±»å‹ã€å…³é”®è¯æ¨¡å¼
   â†’ CREATE_PROJECT, CREATE_FEATURE, FIX_BUG, etc.

================================================================================

ã€ä»»åŠ¡ç±»å‹é€ŸæŸ¥è¡¨ã€‘

task_type    | ä½ç½®  | Agent        | æ¨¡å‹      | è¯´æ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
dev          | US    | /dev         | Opus     | ç¼–ç¨‹ (Caramel)
review       | US    | /review      | Sonnet   | ä»£ç å®¡æŸ¥
qa           | US    | /qa          | Sonnet   | æµ‹è¯• (å°æ£€)
audit        | US    | /audit       | Sonnet   | å®¡è®¡ (å°å®¡)
exploratory  | US    | /exploratory | Opus     | æ¢ç´¢æ€§éªŒè¯
talk         | HK    | /talk        | MiniMax  | å¯¹è¯ä»»åŠ¡
research     | HK    | null         | -        | è°ƒç ” (éœ€äººå·¥)
data         | HK    | N8N          | -        | æ•°æ®å¤„ç†

================================================================================

ã€KR è¯„åˆ†å…¬å¼ã€‘(planner.js ç¬¬45-78è¡Œ)

  score = 0
  + (åœ¨ç„¦ç‚¹ä¸­ ? 100 : 0)
  + (P0 ? 30 : P1 ? 20 : P2 ? 10 : 0)
  + ((100 - progress) Ã— 0.2)
  + (æˆªæ­¢<7å¤© ? 40 : æˆªæ­¢<14å¤© ? 20 : 0)
  + (é˜Ÿåˆ—ä»»åŠ¡æ•° Ã— 15)

  æœ€ç»ˆé€‰æ‹©: å¾—åˆ†æœ€é«˜çš„ KR

================================================================================

ã€å¸¸è§ä¿®æ”¹ã€‘

ä¿®æ”¹ä»»åŠ¡è·¯ç”±è§„åˆ™
â””â”€ /home/xx/perfect21/cecelia/core/brain/src/task-router.js
   â”œâ”€ LOCATION_MAP (è¡Œ 42-53)
   â”œâ”€ SINGLE_TASK_PATTERNS (è¡Œ 10-24)
   â””â”€ FEATURE_PATTERNS (è¡Œ 26-40)

æ·»åŠ æ–° task_type (éœ€æ”¹ 3 å¤„)
â”œâ”€ task-router.js: LOCATION_MAP
â”œâ”€ tick.js: TASK_TYPE_AGENT_MAP (è¡Œ 42-48)
â””â”€ actions.js: isSystemTask() (å¦‚éœ€è¦)

ä¿®æ”¹è°ƒåº¦è¯„åˆ†
â””â”€ planner.js: scoreKRs() å‡½æ•° (è¡Œ 45-78)

æ·»åŠ æ–° Action (éœ€æ”¹ 3 å¤„)
â”œâ”€ thalamus.js: ACTION_WHITELIST (è¡Œ 142-187)
â”œâ”€ decision-executor.js: actionHandlers
â””â”€ actions.js: å®ç°å…·ä½“é€»è¾‘

================================================================================

ã€ä¸˜è„‘ Action ç™½åå•åˆ†ç±»ã€‘(30+ ä¸ª)

ä»»åŠ¡æ“ä½œ (8):    dispatch_task, create_task, cancel_task, retry_task,
                  reprioritize_task, pause_task, resume_task, mark_task_blocked,
                  quarantine_task

OKR æ“ä½œ (3):    create_okr, update_okr_progress, assign_to_autumnrice

é€šçŸ¥/æ—¥å¿— (2):   notify_user, log_event

å‡çº§ (2):        escalate_to_brain, request_human_review

åˆ†æ (2):        analyze_failure, predict_progress

è§„åˆ’ (1):        create_proposal

å­¦ä¹  (3):        create_learning, update_learning, trigger_rca

ç”Ÿå‘½å‘¨æœŸ (3):    update_task_prd, archive_task, defer_task

ç³»ç»Ÿ (2):        no_action, fallback_to_tick

================================================================================

ã€æ„å›¾è¯†åˆ«ä½“ç³»ã€‘(9 ç§)

CREATE_PROJECT  â†’ "æˆ‘æƒ³åšä¸€ä¸ª GMV Dashboard"
CREATE_FEATURE  â†’ "ç»™ç™»å½•é¡µé¢åŠ ä¸€ä¸ªå¿˜è®°å¯†ç åŠŸèƒ½"
CREATE_GOAL     â†’ "åˆ›å»ºä¸€ä¸ª P0 ç›®æ ‡"
CREATE_TASK     â†’ "æ·»åŠ ä»»åŠ¡ï¼šä¿®å¤ç™»å½•è¶…æ—¶"
FIX_BUG         â†’ "ä¿®å¤è´­ç‰©è½¦é¡µé¢çš„ä»·æ ¼é—®é¢˜"
REFACTOR        â†’ "é‡æ„ç”¨æˆ·æ¨¡å—ä»£ç "
EXPLORE         â†’ "å¸®æˆ‘çœ‹çœ‹è¿™ä¸ª API æ€ä¹ˆç”¨"
QUERY_STATUS    â†’ "å½“å‰æœ‰å“ªäº›ä»»åŠ¡ï¼Ÿ"
QUESTION        â†’ "ä¸ºä»€ä¹ˆè¿™é‡Œä¼šæŠ¥é”™ï¼Ÿ"

================================================================================

ã€è°ƒåº¦æµç¨‹ã€‘(planner.js ç¬¬ 302-391 è¡Œ)

1. æŸ¥è¯¢å…¨å±€çŠ¶æ€ (getGlobalState)
2. æ£€æŸ¥ PR Plans (skipPrPlans = false)
   â”œâ”€ æŒ‰ sequence æ’åº
   â”œâ”€ æ£€æŸ¥ä¾èµ–å…³ç³» (depends_on)
   â””â”€ è¿”å›ç¬¬ä¸€ä¸ªå¯æ‰§è¡Œçš„ PR Plan
3. ä¼ ç»Ÿ KR è°ƒåº¦ (æ— å¯ç”¨ PR Plan æ—¶)
   â”œâ”€ scoreKRs: ç»™ KR è¯„åˆ†
   â”œâ”€ selectTargetKR: é€‰æ‹©å¾—åˆ†æœ€é«˜çš„ KR
   â”œâ”€ selectTargetProject: é€‰æ‹©ä¸ KR å…³è”çš„é¡¹ç›®
   â””â”€ generateNextTask: è·å–ä¸‹ä¸€ä¸ªå¾…æ‰§è¡Œä»»åŠ¡
4. è¿”å›è§„åˆ’ç»“æœ

================================================================================

ã€èµ„æºç®¡ç†é˜ˆå€¼ã€‘(executor.js ç¬¬ 127-143 è¡Œ)

CPU_CORES            = å®é™… CPU æ ¸æ•°
TOTAL_MEM_MB         = å®é™…æ€»å†…å­˜ (MB)
MEM_PER_TASK_MB      = 500         (æ¯ä¸ªä»»åŠ¡é¢„ä¼°å†…å­˜)
CPU_PER_TASK         = 0.5         (æ¯ä¸ªä»»åŠ¡é¢„ä¼°æ ¸æ•°)
INTERACTIVE_RESERVE  = 2           (ä¸ºç”¨æˆ·ç•™ 2 ä¸ªå¸­ä½)
USABLE_MEM_MB        = TOTAL * 0.8
USABLE_CPU           = CPU_CORES * 0.8
LOAD_THRESHOLD       = CPU_CORES * 0.85 - (2 Ã— 0.5)
MEM_AVAILABLE_MIN_MB = TOTAL * 0.15 + (2 Ã— 500)
SWAP_USED_MAX_PCT    = 70

===============================================================================

ã€ä¸‰å¤§ä¼˜åŒ–æ–¹å‘ã€‘

A. èƒ½åŠ›åŒ¹é…ç³»ç»Ÿ (Capability Matching)
   ç°çŠ¶: å›ºå®š task_type â†’ å›ºå®š agent
   ç›®æ ‡: åŠ¨æ€é€‰æ‹©æœ€é€‚åˆçš„ agent
   å…³é”®: capabilities è¡¨ã€task å±æ€§æ‰©å±•ã€åŠ¨æ€è¯„åˆ†

B. ä¾èµ–æ„ŸçŸ¥è°ƒåº¦ (Dependency-Aware Scheduling)
   ç°çŠ¶: åªæœ‰ PR Plans æ”¯æŒä¾èµ–
   ç›®æ ‡: å…¨é“¾è·¯ä¾èµ–ç®¡ç† + å®¹é‡è§„åˆ’
   å…³é”®: tasks.depends_onã€å®¹é‡é¢„æµ‹ã€é£é™©è¯„åˆ†

C. åŠ¨æ€ Action Registry (Dynamic Actions)
   ç°çŠ¶: Action ç™½åå•ç¡¬ç¼–ç 
   ç›®æ ‡: æ•°æ®åº“é©±åŠ¨çš„ action registry
   å…³é”®: action_registry è¡¨ã€å†å²å†³ç­–èåˆ

================================================================================

ã€è¯¦ç»†æ–‡æ¡£ã€‘

å®Œæ•´ç ”ç©¶æŠ¥å‘Š: /home/xx/perfect21/cecelia/core/ROUTING_RESEARCH.md (628 è¡Œ)
å¿«é€Ÿå‚è€ƒæŒ‡å—: /home/xx/perfect21/cecelia/core/ROUTING_RESEARCH_SUMMARY.md (197 è¡Œ)
æœ¬å‚è€ƒå¡:    /home/xx/perfect21/cecelia/core/ROUTING_QUICK_REFERENCE.txt

================================================================================
ç ”ç©¶å®Œæˆæ—¶é—´: 2026-02-18
================================================================================
