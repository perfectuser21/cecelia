# DoD: Update Golden Path with PR Plans Coverage

## 验收清单

### 1. Golden Path 脚本更新 ✅
- [ ] 增加 Step 6: Check PR Plans API
- [ ] 检查 `GET /api/brain/pr-plans` 返回有效 JSON 数组
- [ ] 更新步骤计数：5/5 → 6/6
- [ ] 保持总执行时间 < 35s
- **Test**: 本地运行 `bash scripts/goldenpath-check.sh` 通过

### 2. 端点检查逻辑 ✅
- [ ] `curl -sf` 调用 `/api/brain/pr-plans`
- [ ] 使用 `jq` 验证返回值是数组类型
- [ ] 如果失败，调用 `fail()` 函数
- [ ] 如果成功，调用 `pass()` 函数
- **Test**: 返回格式正确（`type == "array"`）

### 3. 注释说明 ✅
- [ ] 在脚本头部注释中增加说明
- [ ] 指向 E2E test 文件位置
- [ ] 说明 Golden Path 是轻量级检查
- **Test**: 注释清晰易懂

### 4. 本地测试通过 ✅
- [ ] 运行 `bash scripts/goldenpath-check.sh`
- [ ] 所有 6 个步骤 PASS
- [ ] 执行时间 < 35s
- **Test**: 无失败输出

### 5. CI 验证 ✅
- [ ] 推送代码触发 CI
- [ ] Golden Path 在 CI 中通过
- [ ] 其他测试不受影响
- **Test**: CI 全绿

### 6. 代码质量 ✅
- [ ] 遵循现有脚本风格
- [ ] 变量命名一致
- [ ] 错误处理完整
- **Test**: shellcheck 无 warning

## CI 检查映射

| DoD 项 | Test 文件/脚本 | CI Job |
|--------|---------------|--------|
| Golden Path 更新 | scripts/goldenpath-check.sh | Brain (Node.js) |
| 端点检查 | Step 6 in goldenpath-check.sh | Brain (Node.js) |
| E2E 测试不受影响 | three-layer-decomposition-e2e.test.js | Brain (Node.js) |

## RCI 覆盖率

P0 功能（轻量级检查）:
- ✅ PR Plans API 端点可访问性

P1 功能（完整测试在 E2E）:
- 在 `three-layer-decomposition-e2e.test.js` 中已覆盖
