# DoD: Three-Pool Slot Allocation System

## Acceptance Criteria

- [ ] New `brain/src/slot-allocator.js` module exists | Test: slot-allocator.test.js
- [ ] `detectUserSessions()` correctly classifies headed vs headless processes | Test: slot-allocator.test.js > detectUserSessions
- [ ] `detectUserMode()` returns absent/interactive/team based on headed count | Test: slot-allocator.test.js > detectUserMode
- [ ] `calculateSlotBudget()` computes correct Pool A/B/C budgets | Test: slot-allocator.test.js > calculateSlotBudget
- [ ] Pool C = total - user_budget - cecelia_budget, clamped to 0 | Test: slot-allocator.test.js > pool math
- [ ] Team mode (3+ headed) â†’ Pool C = 0 | Test: slot-allocator.test.js > team mode
- [ ] tick.js dispatch uses slot budget instead of flat AUTO_DISPATCH_MAX | Test: existing tick tests pass
- [ ] GET /api/brain/slots returns pool status JSON | Test: manual or integration
- [ ] Graceful: never kills running tasks, only stops new dispatches | Test: design review
- [ ] All existing tests pass (npx vitest run) | Test: CI
- [ ] facts-check passes | Test: CI
- [ ] version-sync passes | Test: CI
