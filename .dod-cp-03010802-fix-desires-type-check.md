---
id: dod-fix-desires-type-check
version: 1.0.0
created: 2026-03-01
updated: 2026-03-01
changelog:
  - 1.0.0: 初始版本
---

# DoD: 修复 desires_type_check 约束

## 验收清单

- [x] migration 095 文件存在：`packages/brain/migrations/095_fix_desires_type_check.sql`
  Test: manual:bash -c "ls packages/brain/migrations/095_fix_desires_type_check.sql"
- [x] migration 095 包含 DROP + ADD CONSTRAINT，覆盖全部 8 种类型
  Test: manual:bash -c "grep -q 'follow_up' packages/brain/migrations/095_fix_desires_type_check.sql"
- [x] selfcheck.js EXPECTED_SCHEMA_VERSION 更新为 '095'
  Test: manual:bash -c "grep -q \"EXPECTED_SCHEMA_VERSION = '095'\" packages/brain/src/selfcheck.js"
- [x] facts-check 通过
  Test: manual:node scripts/facts-check.mjs
- [x] version-sync 通过
  Test: manual:bash scripts/check-version-sync.sh
