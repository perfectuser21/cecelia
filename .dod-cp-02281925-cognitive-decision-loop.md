---
id: dod-cp-02281925-cognitive-decision-loop
version: 1.0.0
created: 2026-02-28
updated: 2026-02-28
changelog:
  - 1.0.0: 初始版本
---

# DoD: Cecelia 认知-决策双闭环

## 验收清单

### 方向1：情绪 → 调度

- [x] 情绪评估：从 DB 获取 queueDepth（queued 任务数）和 successRate（最近成功率）
- [x] `effectiveDispatchMax` 乘以 `emotion.dispatch_rate_modifier`
- [x] `overloaded` 状态：log "情绪过载，跳过本轮派发" 并跳过
- [x] `cognitive-core.js` importance 0.6 → 6（修复叙事写入）

### 方向3：反刍 → 计划

- [x] `planner.js` 新增 `buildInsightAdjustments(krIds)` 函数
- [x] `scoreKRs()` 注入 insight 调整量

### 质量

- [ ] 新增测试：emotion-dispatch.test.js（情绪门禁 + 修正系数）
- [ ] 新增测试：planner-insight.test.js（buildInsightAdjustments 得分调整）
- [ ] Brain CI 通过（facts-check + version-sync）

## Test

- `manual:bash -c "grep 'dispatch_rate_modifier' packages/brain/src/tick.js | grep -v '//' | wc -l | grep -qv '^0$'"`
- `manual:bash -c "grep 'buildInsightAdjustments' packages/brain/src/planner.js | wc -l | grep -qv '^0$'"`
- `manual:bash -c "grep 'importance, 6' packages/brain/src/cognitive-core.js | wc -l | grep -q 1"`
- `npm:test:packages/brain`
