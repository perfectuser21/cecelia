---
id: prd-migrate-local-routes
version: 1.0.0
created: 2026-02-26
updated: 2026-02-26
changelog:
  - 1.0.0: 初始版本
---

# PRD: 将 5 个本地 API 路由迁移到 Brain

## 背景

PR #15 将前端代理从 PM2 Express(5211) 改为 frontend-proxy.js 直连 Brain(5221)。
frontend-proxy.js 把所有 /api/* 转发到 Brain，但原 Express server.ts 中有 5 个本地路由
在 Brain 没有对应实现，导致前端调用这些路由会 404。

## 需要迁移的 5 个路由

1. `/api/cluster/kill-session` — 杀死指定 Claude 进程（POST）
2. `/api/cluster/scan-sessions` — 扫描本机活跃 Claude 进程（GET）
3. `/api/tasks/projects` — 列出所有项目（GET）
4. `/api/v1/vps-monitor/stats` — VPS 资源统计（GET）
5. `/api/v1/vps-monitor/services` — 服务状态列表（GET）

## 迁移策略

将这 5 个路由的实现代码从 apps/api/src/ 迁移到 packages/brain/src/，
注册到 Brain 的 Express 路由中。前端调用路径不变（frontend-proxy 会将
/api/cluster/* 改写为 /api/brain/cluster/* 转发到 Brain）。

## 成功标准

- Brain 启动后能响应全部 5 个路由
- 前端通过 frontend-proxy 调用这些路由返回正确数据
- 原 apps/api 中对应路由文件无需删除（保留历史参考），但不再被运行时使用
