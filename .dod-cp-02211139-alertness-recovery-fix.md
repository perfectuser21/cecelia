---
id: dod-cp-02211139-alertness-recovery-fix
version: 1.0.0
created: 2026-02-21
updated: 2026-02-21
changelog:
  - 1.0.0: 初始版本
---

## DoD - Alertness 渐进式恢复 Bug 修复

### 验收清单

- [ ] **D1**: `evaluateAlertness()` 在目标降级被 skip 规则 block 时，自动尝试降一级（currentLevel - 1）
  - Test: `alertness-recovery.test.js` - "ALERT→AWARE step recovery when CALM is blocked"

- [ ] **D2**: ALERT (3) + healthScore=100 → 第一次 tick 降到 AWARE (2)
  - Test: `alertness-recovery.test.js` - "does not jump from ALERT to CALM directly"

- [ ] **D3**: AWARE (2) + healthScore=100 → 下一次 tick 降到 CALM (1)
  - Test: `alertness-recovery.test.js` - "full two-step recovery ALERT→AWARE→CALM"

- [ ] **D4**: 恢复时 reason 包含 "Step recovery" 字样，便于日志追踪
  - Test: `alertness-recovery.test.js` - "step recovery reason contains Step recovery"

- [ ] **D5**: 原有 checkTransitionRules 逻辑不变，升级路径不受影响
  - Test: 现有 alertness 相关测试全部通过（不回归）

- [ ] **D6**: 所有现有测试通过（npm test）
