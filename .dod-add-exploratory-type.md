# DoD: Add exploratory Task Type Support

## Code Changes

### task-router.js
- [ ] Line 44-52: 在 LOCATION_MAP 添加 `'exploratory': 'us'`
- [ ] Line 163: 在 isValidTaskType() 添加 `'exploratory'`

### executor.js
- [ ] Line 556-567: 在 getSkillForTaskType() 添加 `'exploratory': '/exploratory'`
- [ ] Line 600-610: 在 getPermissionModeForTaskType() 添加 `'exploratory': 'bypassPermissions'`

## Unit Tests

### task-router.js Tests
- [ ] `getTaskLocation('exploratory')` 返回 `'us'`
- [ ] `isValidTaskType('exploratory')` 返回 `true`
- [ ] `routeTaskCreate({ task_type: 'exploratory' })` 返回正确路由

### executor.js Tests
- [ ] `getSkillForTaskType('exploratory')` 返回 `'/exploratory'`
- [ ] `getPermissionModeForTaskType('exploratory')` 返回 `'bypassPermissions'`

## Manual Testing

- [ ] 创建 exploratory task via API:
  ```bash
  curl -X POST http://localhost:5221/api/brain/tasks \
    -H "Content-Type: application/json" \
    -d '{
      "title": "Test exploratory task",
      "task_type": "exploratory",
      "description": "Test PRD content"
    }'
  ```
- [ ] 验证 task 创建成功（不会被 isValidTaskType 拒绝）
- [ ] 验证 task location = 'us'
- [ ] 触发 Brain Tick Loop，验证能派发 exploratory task
- [ ] 检查日志：执行时调用 `/exploratory` skill
- [ ] 检查权限模式为 bypassPermissions

## Version Sync

- [ ] 版本号 patch bump: 1.31.2 → 1.31.3
- [ ] `brain/package.json` 更新
- [ ] `brain/package-lock.json` 同步
- [ ] `brain/VERSION` 文件同步
- [ ] `.brain-versions` 文件同步
- [ ] `DEFINITION.md` brain_version 同步

## CI/CD

- [ ] 所有现有测试通过
- [ ] Facts Consistency check 通过
- [ ] Version Sync check 通过
- [ ] GoldenPath E2E check 通过
- [ ] PR 创建并合并到 develop

## Documentation

- [ ] 更新 `DEFINITION.md` 中的 task types 列表（如有）
- [ ] 验证 `LOCATION_MAP` 注释准确
- [ ] 验证 `getSkillForTaskType()` 注释准确
