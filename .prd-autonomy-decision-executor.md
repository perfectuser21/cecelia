---
id: prd-autonomy-decision-executor
version: 1.0.0
created: 2026-02-26
updated: 2026-02-26
changelog:
  - 1.0.0: 初始版本
---

# PRD: Cecelia 自主决策执行 — 让管家真正自己做事

## 背景

Cecelia 的大脑（Brain）有完整的决策系统：Tick 循环每 5 分钟生成决策，cortex 分析失败原因，decision-executor 有执行能力。

**但她不敢做。**

当前 `decision.js` 中 `generateDecision()` 的置信度逻辑：
- 初始 confidence = 0.9
- 有 blocked tasks → confidence = 0.85（可自动执行）
- 有 failed tasks → confidence = 0.7（低于 0.8 阈值，永远挂起）

结果：`decisions` 表积压了 38 个 `pending` 状态的 retry 决策，全部 confidence=0.7，全部等待人工审批——但没有审批 UI，也没有人审批。

## 问题

1. `retry` 动作的 confidence 被硬编码为 0.7，永远低于 AUTO_EXECUTE_CONFIDENCE (0.8)
2. 所有 retry 决策堆积为 pending，永不执行
3. 失败的任务永远停在 failed 状态，retry_count 始终为 0
4. Cecelia 表现为"知道该做什么但不做"——完全不像自主管家

## 目标

让 Cecelia 能自主执行安全的决策动作，不需要人工审批。

## 方案

### 核心改动：按动作风险分级，安全动作直接执行

引入 Action Safety Classification（动作安全分级）：

| 动作类型 | 风险级别 | 行为 |
|----------|----------|------|
| retry | SAFE | 直接执行（已有 max_retries 保护） |
| reprioritize | SAFE | 直接执行（只改优先级） |
| skip | SAFE | 直接执行 |
| escalate | REVIEW | 记录日志，不自动执行 |

### 改动点

1. **`packages/brain/src/decision.js`**:
   - `generateDecision()` 中不再对 retry 降低 confidence 到 0.7
   - 或者：引入 `SAFE_ACTIONS` 列表，安全动作无视 confidence 直接执行
   - 清理 38 个积压的 pending 决策

2. **`packages/brain/src/tick.js`**:
   - 决策执行路径增加安全动作判断：即使 confidence < 0.8，安全动作也自动执行
   - 只有非安全动作（escalate 等）才需要审批

3. **测试**:
   - 验证 retry 动作能自动执行
   - 验证 escalate 动作仍需审批
   - 验证 max_retries 保护仍然有效

## 成功标准

1. 失败任务在下一个 tick 自动重试（不再 pending）
2. `decisions` 表不再堆积未执行的 safe 决策
3. 危险动作（escalate）仍然需要审批
4. Brain 日志显示自动执行记录

## 非目标

- 不改 thalamus/cortex 管道（那条路径已经可以自动执行）
- 不改前端 UI
- 不改 retry 上限逻辑
